(this["webpackJsonpcrafty-control"]=this["webpackJsonpcrafty-control"]||[]).push([[8],{153:function(e){e.exports=JSON.parse('{"name":"crafty-control","version":"1.0.1-beta","private":true,"dependencies":{"@ionic/react":"^4.11.0","@ionic/react-router":"^4.11.0","@types/jest":"^24.0.18","@types/node":"^12.7.12","@types/react":"^16.9.5","@types/react-dom":"^16.9.1","@types/react-router":"^5.1.1","@types/react-router-dom":"^5.1.0","babel-polyfill":"^6.26.0","date-fns":"^2.8.1","ionicons":"^4.6.3","react":"^16.10.2","react-app-polyfill":"^1.0.5","react-dom":"^16.10.2","react-router":"^5.1.0","react-router-dom":"^5.1.0","react-scripts":"3.2.0","react-visual-graphic":"^0.2.0","typescript":"3.6.3","typescript-task-queue":"^1.0.4"},"scripts":{"ionic:build:before":"set PUBLIC_URL=https://github.cataford.com/crafty/","start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version","ie >= 11"]},"description":"Crafty Control Application","devDependencies":{"@types/date-fns":"^2.6.0","@types/web-bluetooth":"0.0.4","cross-env":"^6.0.3"}}')},185:function(e,t,a){e.exports=a(315)},191:function(e,t,a){var n={"./ion-action-sheet-controller_8.entry.js":[321,43],"./ion-action-sheet-ios.entry.js":[322,44],"./ion-action-sheet-md.entry.js":[323,45],"./ion-alert-ios.entry.js":[324,24],"./ion-alert-md.entry.js":[325,25],"./ion-app_8-ios.entry.js":[326,11],"./ion-app_8-md.entry.js":[327,12],"./ion-avatar_3-ios.entry.js":[328,46],"./ion-avatar_3-md.entry.js":[329,47],"./ion-back-button-ios.entry.js":[330,48],"./ion-back-button-md.entry.js":[331,49],"./ion-backdrop-ios.entry.js":[332,81],"./ion-backdrop-md.entry.js":[333,82],"./ion-button_2-ios.entry.js":[334,50],"./ion-button_2-md.entry.js":[335,51],"./ion-card_5-ios.entry.js":[336,52],"./ion-card_5-md.entry.js":[337,53],"./ion-checkbox-ios.entry.js":[338,54],"./ion-checkbox-md.entry.js":[339,55],"./ion-chip-ios.entry.js":[340,56],"./ion-chip-md.entry.js":[341,57],"./ion-col_3.entry.js":[342,83],"./ion-datetime_3-ios.entry.js":[343,20],"./ion-datetime_3-md.entry.js":[344,21],"./ion-fab_3-ios.entry.js":[345,58],"./ion-fab_3-md.entry.js":[346,59],"./ion-img.entry.js":[347,84],"./ion-infinite-scroll_2-ios.entry.js":[348,39],"./ion-infinite-scroll_2-md.entry.js":[349,40],"./ion-input-ios.entry.js":[350,60],"./ion-input-md.entry.js":[351,61],"./ion-item-option_3-ios.entry.js":[352,62],"./ion-item-option_3-md.entry.js":[353,63],"./ion-item_8-ios.entry.js":[354,64],"./ion-item_8-md.entry.js":[355,65],"./ion-loading-ios.entry.js":[356,26],"./ion-loading-md.entry.js":[357,27],"./ion-menu_4-ios.entry.js":[358,18],"./ion-menu_4-md.entry.js":[359,19],"./ion-modal-ios.entry.js":[360,14],"./ion-modal-md.entry.js":[361,15],"./ion-nav_5.entry.js":[362,13],"./ion-popover-ios.entry.js":[363,16],"./ion-popover-md.entry.js":[364,17],"./ion-progress-bar-ios.entry.js":[365,66],"./ion-progress-bar-md.entry.js":[366,67],"./ion-radio_2-ios.entry.js":[367,32],"./ion-radio_2-md.entry.js":[368,33],"./ion-range-ios.entry.js":[369,68],"./ion-range-md.entry.js":[370,69],"./ion-refresher_2-ios.entry.js":[371,41],"./ion-refresher_2-md.entry.js":[372,42],"./ion-reorder_2-ios.entry.js":[373,37],"./ion-reorder_2-md.entry.js":[374,38],"./ion-ripple-effect.entry.js":[375,85],"./ion-route_4.entry.js":[376,70],"./ion-searchbar-ios.entry.js":[377,28],"./ion-searchbar-md.entry.js":[378,29],"./ion-segment_2-ios.entry.js":[379,71],"./ion-segment_2-md.entry.js":[380,72],"./ion-select_3-ios.entry.js":[381,34],"./ion-select_3-md.entry.js":[382,35],"./ion-slide_2-ios.entry.js":[383,86],"./ion-slide_2-md.entry.js":[384,87],"./ion-spinner.entry.js":[385,73],"./ion-split-pane-ios.entry.js":[386,88],"./ion-split-pane-md.entry.js":[387,89],"./ion-tab-bar_2-ios.entry.js":[388,74],"./ion-tab-bar_2-md.entry.js":[389,75],"./ion-tab_2.entry.js":[390,36],"./ion-text.entry.js":[391,76],"./ion-textarea-ios.entry.js":[392,77],"./ion-textarea-md.entry.js":[393,78],"./ion-toast-ios.entry.js":[394,30],"./ion-toast-md.entry.js":[395,31],"./ion-toggle-ios.entry.js":[396,22],"./ion-toggle-md.entry.js":[397,23],"./ion-virtual-scroll.entry.js":[398,90]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=191,e.exports=r},192:function(e,t,a){var n={"./ion-icon.entry.js":[402,98]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=192,e.exports=r},197:function(e,t,a){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},314:function(e,t,a){},315:function(e,t,a){"use strict";a.r(t);var n,r=a(0),s=a.n(r),c=a(69),i=a.n(c),o=a(9),l=a(1),u=a(170),p=a(406),d=a(407),h=a(408),m=a(20),f=a(4),y="CRAFTY/CONNECTING",b="CRAFTY/DISCONNECTED",g="CRAFTY/CONNECTED",E="CRAFTY/SET_CURRENT_TEMPERATURE",v="CRAFTY/SET_SETPOINT",j="CRAFTY/SET_BOOST",w="CRAFTY/SET_LED",C="CRAFTY/SET_BATTERY_PERCENT",x="CRAFTY/UPDATE_UNITS",O="CRAFTY/UPDATE_SETTINGS",S="CRAFTY/UPDATING",k="CRAFTY/UPDATED",T="CRAFTY/SET_SERIAL",_="CRAFTY/SET_MODEL",P="CRAFTY/SET_VERSION",F="CRAFTY/SET_HOURS_OF_OP",N="CRAFTY/SETPOINT_STEP",A="CRAFTY/BOOST_STEP";!function(e){e[e.F=0]="F",e[e.C=1]="C"}(n||(n={}));var R=localStorage.getItem("crafty-control-units"),D=localStorage.getItem("crafty-control-setpoint-step"),U=localStorage.getItem("crafty-control-boost-step"),I={settings:{units:R?parseInt(R):n.C,setPointStep:D?parseInt(D):5,boostStep:U?parseInt(U):1},info:{serial:"",model:"",version:"",hoursOfOperation:0,data:[]},connecting:!1,connected:!1,updating:!1,temperature:0,setPoint:0,boost:0,batteryPercent:0,craftySettings:0,led:-1},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(f.a)({},e,{connecting:!0});case g:return Object(f.a)({},e,{connecting:!1,connected:!0});case E:return Object(f.a)({},e,{temperature:t.payload});case v:return Object(f.a)({},e,{updating:!1,setPoint:t.payload});case C:return Object(f.a)({},e,{batteryPercent:t.payload});case j:return Object(f.a)({},e,{updating:!1,boost:t.payload});case w:return Object(f.a)({},e,{updating:!1,led:t.payload});case b:return Object(f.a)({},e,{connected:!1,connecting:!1});case x:return localStorage.setItem("crafty-control-units",t.payload.toString()),Object(f.a)({},e,{settings:Object(f.a)({},e.settings,{units:t.payload})});case N:return localStorage.setItem("crafty-control-setpoint-step",t.payload.toString()),Object(f.a)({},e,{settings:Object(f.a)({},e.settings,{setPointStep:t.payload})});case A:return localStorage.setItem("crafty-control-boost-step",t.payload.toString()),Object(f.a)({},e,{settings:Object(f.a)({},e.settings,{boostStep:t.payload})});case O:return Object(f.a)({},e,{updating:!1,craftySettings:t.payload});case S:return Object(f.a)({},e,{updating:!0});case k:return Object(f.a)({},e,{updating:!1});case T:return Object(f.a)({},e,{info:Object(f.a)({},e.info,{serial:t.payload})});case _:return Object(f.a)({},e,{info:Object(f.a)({},e.info,{model:t.payload})});case F:return Object(f.a)({},e,{info:Object(f.a)({},e.info,{hoursOfOperation:t.payload})});case P:return Object(f.a)({},e,{info:Object(f.a)({},e.info,{version:t.payload})});default:return e}},Y=s.a.createContext(void 0);Y.Consumer;a(197);var M=a(2),L=a.n(M),q=a(5),V="00000001-4c45-4b43-4942-265a524f5453",W="00000011-4c45-4b43-4942-265a524f5453",z="00000021-4c45-4b43-4942-265a524f5453",X="00000031-4c45-4b43-4942-265a524f5453",G="00000041-4c45-4b43-4942-265a524f5453",J="00000051-4c45-4b43-4942-265a524f5453",H="00000002-4c45-4b43-4942-265a524f5453",K="00000022-4c45-4b43-4942-265a524f5453",Q="00000032-4c45-4b43-4942-265a524f5453",Z="00000052-4c45-4b43-4942-265a524f5453",$="00000003-4c45-4b43-4942-265a524f5453",ee="00000023-4c45-4b43-4942-265a524f5453",te="000001c3-4c45-4b43-4942-265a524f5453",ae=a(16),ne=a(173),re=new function e(){var t=this;Object(q.a)(this,e),this.units=n.C,this.dispatch=void 0,this.service=void 0,this.setPointCharacteristic=void 0,this.boostCharacteristic=void 0,this.temperatureCharacteristic=void 0,this.settingsCharacteristic=void 0,this.ledCharacteristic=void 0,this.batteryCharacteristic=void 0,this.queue=new ne.TaskQueue({autorun:!0,stoppable:!1}),this.connect=function(e,a){var n,r,s,c,i;return L.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t.units=e,t.dispatch=a,o.next=4,L.a.awrap(navigator.bluetooth.requestDevice({filters:[{name:"Storz&Bickel"},{name:"STORZ&BICKEL"}],optionalServices:[V,H,$]}));case 4:if((n=o.sent)&&n.gatt){o.next=7;break}throw new Error("Failed to retrieve Crafty BLE device.");case 7:return t.dispatch({type:y}),o.next=10,L.a.awrap(n.gatt.connect());case 10:if(r=o.sent){o.next=13;break}throw new Error("Failed to retrieve BLE server.");case 13:return o.next=15,L.a.awrap(r.getPrimaryService(V));case 15:return s=o.sent,o.next=18,L.a.awrap(r.getPrimaryService(H));case 18:return c=o.sent,o.next=21,L.a.awrap(r.getPrimaryService($));case 21:if(i=o.sent,s){o.next=24;break}throw new Error("Failed to retrieve primary data service.");case 24:if(c){o.next=26;break}throw new Error("Failed to retrieve metadata service.");case 26:if(i){o.next=28;break}throw new Error("Failed to retrieve miscellaneous data service.");case 28:return o.next=30,L.a.awrap(t.getDataServiceCharacteristics(s));case 30:return o.next=32,L.a.awrap(t.getMetaDataCharacteristics(c));case 32:return o.next=34,L.a.awrap(t.getMiscCharacteristics(i));case 34:return o.next=36,L.a.awrap(t.temperatureCharacteristic.startNotifications());case 36:return t.temperatureCharacteristic.oncharacteristicvaluechanged=function(e){return L.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:t.queue.enqueue((function(){var e;return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,L.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 2:(e=a.sent)&&Object(ae.isNumber)(e)&&t.dispatch({type:E,payload:e});case 4:case"end":return a.stop()}}))}));case 1:case"end":return e.stop()}}))},o.next=39,L.a.awrap(t.batteryCharacteristic.startNotifications());case 39:t.batteryCharacteristic.oncharacteristicvaluechanged=function(e){return L.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:t.queue.enqueue((function(){var e,a;return L.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,L.a.awrap(t.batteryCharacteristic.readValue());case 2:(e=n.sent)&&(a=e.getUint16(0,!0))&&Object(ae.isNumber)(a)&&t.dispatch({type:C,payload:a});case 4:case"end":return n.stop()}}))}));case 1:case"end":return e.stop()}}))},t.dispatch({type:g});case 41:case"end":return o.stop()}}))},this.getDataServiceCharacteristics=function(e){var a,n,r,s,c,i,o;return L.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,L.a.awrap(e.getCharacteristic(W));case 2:if(t.temperatureCharacteristic=l.sent,t.temperatureCharacteristic){l.next=5;break}throw new Error("Failed to retrieve temperature characteristic.");case 5:return l.next=7,L.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 7:return a=l.sent,t.dispatch({type:E,payload:a}),l.next=11,L.a.awrap(e.getCharacteristic(z));case 11:if(t.setPointCharacteristic=l.sent,t.setPointCharacteristic){l.next=14;break}throw new Error("Failed to retrieve setpoint characteristic.");case 14:return l.next=16,L.a.awrap(t.readTemp(t.units,t.setPointCharacteristic,0));case 16:return(n=l.sent)&&Object(ae.isNumber)(n)&&t.dispatch({type:v,payload:n}),l.next=20,L.a.awrap(e.getCharacteristic(X));case 20:if(t.boostCharacteristic=l.sent,t.boostCharacteristic){l.next=23;break}throw new Error("Failed to retrieve the boost characteristic.");case 23:return l.next=25,L.a.awrap(t.readTemp(t.units,t.boostCharacteristic,0));case 25:return(r=l.sent)&&Object(ae.isNumber)(r)&&t.dispatch({type:j,payload:r}),l.next=29,L.a.awrap(e.getCharacteristic(J));case 29:return t.ledCharacteristic=l.sent,l.next=32,L.a.awrap(t.ledCharacteristic.readValue());case 32:return(s=l.sent)&&(c=s.getUint16(0,!0))&&Object(ae.isNumber)(c)&&t.dispatch({type:w,payload:c}),l.next=36,L.a.awrap(e.getCharacteristic(G));case 36:if(t.batteryCharacteristic=l.sent,t.batteryCharacteristic){l.next=39;break}throw new Error("Failed to retrieve the battery characteristic.");case 39:return l.next=41,L.a.awrap(t.batteryCharacteristic.readValue());case 41:(i=l.sent)&&(o=i.getUint16(0,!0))&&Object(ae.isNumber)(o)&&t.dispatch({type:C,payload:o});case 43:case"end":return l.stop()}}))},this.getMiscCharacteristics=function(e){var a,n,r,s,c;return L.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,L.a.awrap(e.getCharacteristic(te));case 2:if(t.settingsCharacteristic=i.sent,t.settingsCharacteristic){i.next=5;break}throw new Error("Failed to retrieve settings characteristic.");case 5:return i.next=7,L.a.awrap(t.settingsCharacteristic.readValue());case 7:return(a=i.sent)&&(n=a.getUint16(0,!0))&&Object(ae.isNumber)(n)&&t.dispatch({type:O,payload:n}),i.next=11,L.a.awrap(e.getCharacteristic(ee));case 11:if(r=i.sent){i.next=14;break}throw new Error("Failed to retrieve hours of operation characteristic.");case 14:return i.next=16,L.a.awrap(r.readValue());case 16:(s=i.sent)&&(c=s.getUint16(0,!0))&&Object(ae.isNumber)(c)&&t.dispatch({type:F,payload:c});case 18:case"end":return i.stop()}}))},this.getMetaDataCharacteristics=function(e){var a,n,r,s,c,i,o,l,u,p;return L.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return a=new TextDecoder("utf8"),d.next=3,L.a.awrap(e.getCharacteristic(Z));case 3:if(n=d.sent){d.next=6;break}throw new Error("Failed to retrieve the serial # characteristic.");case 6:return d.next=8,L.a.awrap(n.readValue());case 8:return(r=d.sent)&&(s=a.decode(r.buffer))&&t.dispatch({type:T,payload:s}),d.next=12,L.a.awrap(e.getCharacteristic(K));case 12:if(c=d.sent){d.next=15;break}throw new Error("Failed to retrieve the model # characteristic.");case 15:return d.next=17,L.a.awrap(c.readValue());case 17:return(i=d.sent)&&(o=a.decode(i.buffer))&&t.dispatch({type:_,payload:o}),d.next=21,L.a.awrap(e.getCharacteristic(Q));case 21:if(l=d.sent){d.next=24;break}throw new Error("Failed to retrieve the version # characteristic.");case 24:return d.next=26,L.a.awrap(l.readValue());case 26:(u=d.sent)&&(p=a.decode(u.buffer))&&t.dispatch({type:P,payload:p});case 28:case"end":return d.stop()}}))},this.updateSetPoint=function(e){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.dispatch({type:S}),t.setPointCharacteristic){a.next=4;break}throw new Error("Failed to retrieve BLE Crafty Set Point Characteristic.");case 4:return a.next=6,L.a.awrap(t.writeTemp(t.units,t.setPointCharacteristic,e));case 6:t.dispatch({type:v,payload:e});case 7:return a.prev=7,t.dispatch({type:k}),a.finish(7);case 10:case"end":return a.stop()}}),null,null,[[0,,7,10]])}));case 1:case"end":return a.stop()}}))},this.updateBoost=function(e){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.dispatch({type:S}),t.boostCharacteristic){a.next=4;break}throw new Error("Failed to retrieve BLE Crafty Boost Characteristic.");case 4:return a.next=6,L.a.awrap(t.writeTemp(t.units,t.boostCharacteristic,e));case 6:t.dispatch({type:j,payload:e});case 7:return a.prev=7,t.dispatch({type:k}),a.finish(7);case 10:case"end":return a.stop()}}),null,null,[[0,,7,10]])}));case 1:case"end":return a.stop()}}))},this.updateLED=function(e){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){var a,n;return L.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t.dispatch({type:S}),t.ledCharacteristic){r.next=4;break}throw new Error("Failed to retrieve BLE Crafty LED Brightness Characteristic.");case 4:return a=new ArrayBuffer(2),(n=new DataView(a)).setUint16(0,e,!0),r.next=10,L.a.awrap(t.ledCharacteristic.writeValue(n));case 10:return r.prev=10,t.dispatch({type:k}),r.finish(10);case 13:case"end":return r.stop()}}),null,null,[[0,,10,13]])}));case 1:case"end":return a.stop()}}))},this.settingUpdating=!1,this.updateCraftySettings=function(e){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.settingUpdating){a.next=2;break}return a.abrupt("return");case 2:t.queue.enqueue((function(){var a,n;return L.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t.settingUpdating=!0,t.dispatch({type:S}),t.settingsCharacteristic){r.next=5;break}throw new Error("Failed to retrieve BLE Crafty Settings Characteristic.");case 5:return a=new ArrayBuffer(2),(n=new DataView(a)).setUint16(0,e,!0),r.next=10,L.a.awrap(t.settingsCharacteristic.writeValue(n));case 10:return r.prev=10,t.settingUpdating=!1,t.dispatch({type:k}),r.finish(10);case 14:case"end":return r.stop()}}),null,null,[[0,,10,14]])}));case 3:case"end":return a.stop()}}))},this.writeTemp=function(e,t,a){var r,s,c;return L.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return r=a,r=e===n.F?Math.round((r-32)/.18):Math.round(r/.1),s=new ArrayBuffer(2),(c=new DataView(s)).setUint16(0,r,!0),i.next=7,L.a.awrap(t.writeValue(c));case 7:case"end":return i.stop()}}))},this.readTemp=function(e,t){var a,r,s,c=arguments;return L.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return a=c.length>2&&void 0!==c[2]?c[2]:1,i.next=3,L.a.awrap(t.readValue());case 3:if(!(r=i.sent)){i.next=10;break}return s=r.getUint16(0,!0),s=e===n.F?Math.round((.18*s+32)*Math.pow(10,a))/Math.pow(10,a):Math.round(.1*s*Math.pow(10,a))/Math.pow(10,a),i.abrupt("return",s);case 10:throw new Error("Failed to read temperature value.");case 11:case"end":return i.stop()}}))},this.updateUnits=function(e){return L.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){var a;return L.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.units=e,n.next=4,L.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 4:return(a=n.sent)&&Object(ae.isNumber)(a)&&t.dispatch({type:E,payload:a}),n.next=8,L.a.awrap(t.readTemp(t.units,t.setPointCharacteristic));case 8:return(a=n.sent)&&Object(ae.isNumber)(a)&&t.dispatch({type:v,payload:a}),n.next=12,L.a.awrap(t.readTemp(t.units,t.boostCharacteristic));case 12:(a=n.sent)&&Object(ae.isNumber)(a)&&t.dispatch({type:j,payload:a});case 14:return n.prev=14,t.dispatch({type:k}),n.finish(14);case 17:case"end":return n.stop()}}),null,null,[[0,,14,17]])}));case 1:case"end":return a.stop()}}))}},se=a(153).version,ce=function(e){var t=e.history,a=Object(r.useContext)(Y),n=a.state,c=a.dispatch,i=Object(r.useState)(!1),o=Object(m.a)(i,2),u=o[0],p=o[1],d=Object(r.useState)(""),h=Object(m.a)(d,2),f=h[0],y=h[1];return s.a.createElement(l.p,null,s.a.createElement(l.k,{class:"connect-version-label"},se),s.a.createElement(l.f,null,s.a.createElement(l.A,null,s.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),s.a.createElement(l.y,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),s.a.createElement(l.e,{class:"content",scrollX:!1,scrollY:!1,fullscreen:!0},s.a.createElement(l.m,{lines:"none"},s.a.createElement(l.n,null,s.a.createElement(l.k,null,"Connect")),s.a.createElement(l.j,{class:"spacer"}),s.a.createElement(l.j,{onClick:function(){re.connect(n.settings.units,c).then((function(){t.push("/home")})).catch((function(e){c({type:b}),y(e),p(!0)}))},hidden:n.connecting||n.connected},s.a.createElement(l.d,{size:"large"},"Connect to Crafty")),s.a.createElement(l.j,{class:"spacer"})),s.a.createElement(l.o,{message:"Connecting ...",isOpen:n.connecting})),s.a.createElement(l.b,{isOpen:u,onDidDismiss:function(){return p(!1)},header:"Error Connecting",message:f,buttons:["Ok"]}))},ie=a(404),oe=a(405),le=(a(301),a(153).version),ue=function(){var e=Object(r.useContext)(Y).state,t=Object(r.useState)(-1),a=Object(m.a)(t,2),c=a[0],i=a[1],u=Object(r.useState)(!1),p=Object(m.a)(u,2),d=p[0],h=p[1];Object(r.useEffect)((function(){(c<=0||!d)&&c!==e.setPoint&&i(e.setPoint)}),[e.setPoint,d,c]);var f=function(t){var a=e.settings.units===n.C?40:104,r=e.settings.units===n.C?210:410,s=Math.floor(t);t<a?s=a:t>r&&(s=r),re.updateSetPoint(s).then((function(){s+e.settings.boostStep>r&&re.updateBoost(r-s)}))},y=function(t){var a=e.settings.units===n.C?210:410,r=Math.floor(t);r<0?r=0:e.setPoint+t>a&&(r=a-e.setPoint),re.updateBoost(r)};return e.connected?s.a.createElement(l.p,null,s.a.createElement(l.k,{class:"version-label"},le),s.a.createElement(l.f,null,s.a.createElement(l.A,null,s.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),s.a.createElement(l.y,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),s.a.createElement(l.e,{class:"content",scrollX:!1,scrollY:!1,fullscreen:!0},s.a.createElement(l.m,{lines:"none"},s.a.createElement(l.n,null,s.a.createElement(l.k,null,"Temperature")),s.a.createElement(l.j,{class:"spacer-home"}),s.a.createElement(l.j,{class:"temperature-item"},s.a.createElement(l.k,{class:"temperature-label"},e.temperature.toFixed(1),"\xb0",e.settings.units===n.C?"C":"F")),s.a.createElement(l.j,{class:"setpoint-item"},s.a.createElement(l.g,{class:"spacer"}),s.a.createElement(l.d,{class:"setpoint-button",onClick:function(){return f(e.setPoint-e.settings.setPointStep)}},s.a.createElement(l.g,{icon:ie.a})),s.a.createElement(l.k,{class:"setpoint-input",onClick:function(){return h(!0)}},e.setPoint.toFixed(1),"\xb0",e.settings.units===n.C?"C":"F"),s.a.createElement(l.d,{class:"setpoint-button",onClick:function(){return f(e.setPoint+e.settings.setPointStep)}},s.a.createElement(l.g,{icon:oe.a})),s.a.createElement(l.g,{class:"spacer"})),s.a.createElement(l.j,null,s.a.createElement(l.g,{class:"spacer"}),s.a.createElement("svg",{width:200,height:60,className:"battery",key:e.batteryPercent},s.a.createElement("rect",{width:180,height:40,stroke:"#CCC",strokeWidth:2,x:5,y:5,rx:10,ry:10,className:"battery-container"}),s.a.createElement("rect",{width:Math.round(e.batteryPercent/100*160),height:20,x:15,y:15,rx:5,ry:5,className:"battery-gauge"}),s.a.createElement("rect",{width:10,height:20,x:185,y:15,className:"battery-button"}),s.a.createElement("text",{x:100,y:30,className:"battery-text"},e.batteryPercent.toFixed(0),"%")),s.a.createElement(l.g,{class:"spacer"})),s.a.createElement(l.j,{class:"spacer-home"}),s.a.createElement(l.j,{class:"booster"},s.a.createElement(l.s,{class:"booster-row"},s.a.createElement(l.d,{class:"booster-button",onClick:function(){return y(e.boost-e.settings.boostStep)}},s.a.createElement(l.g,{icon:ie.a})),s.a.createElement(l.s,{class:"booster-text"},s.a.createElement(l.k,{class:"booster-title"},"Booster Temperature"),s.a.createElement(l.g,{class:"spacer"}),s.a.createElement(l.k,{class:"booster-value"},"+",e.boost," \xb0",e.settings.units===n.C?"C":"F")),s.a.createElement(l.d,{class:"booster-button",onClick:function(){return y(e.boost+e.settings.boostStep)}},s.a.createElement(l.g,{icon:oe.a})))))),s.a.createElement(l.b,{isOpen:d,onDidDismiss:function(){return h(!1)},header:"Set Point",message:"Please enter a new set point value",inputs:[{name:"setPoint",label:"Set Point",type:"number",value:c}],buttons:[{text:"Ok",handler:function(e){f(e.setPoint)}}]})):s.a.createElement(o.a,{to:"/connect"})},pe=(a(302),function(e){e.history;var t,a=Object(r.useContext)(Y),c=a.state,i=a.dispatch,u=Object(r.useState)((function(){return 1!==(1&c.craftySettings)})),p=Object(m.a)(u,2),d=p[0],h=p[1],f=Object(r.useState)((function(){return 2!==(2&c.craftySettings)})),y=Object(m.a)(f,2),b=y[0],g=y[1],E=Object(r.useState)(-1),v=Object(m.a)(E,2),j=v[0],C=v[1],S=Object(r.useState)((function(){return c.settings.setPointStep})),k=Object(m.a)(S,2),T=k[0],_=k[1],P=Object(r.useState)((function(){return c.settings.boostStep})),F=Object(m.a)(P,2),R=F[0],D=F[1];Object(r.useEffect)((function(){var e=1!==(1&c.craftySettings);d!==e&&h(e),e=2!==(2&c.craftySettings),b!==e&&g(e),-1===j&&c.led>=0&&C(c.led),T!==c.settings.setPointStep&&_(c.settings.setPointStep),R!==c.settings.boostStep&&D(c.settings.boostStep)}),[c.craftySettings,d,b,c.led,j,T,c.settings.setPointStep,R,c.settings.boostStep]);return c.connected?s.a.createElement(l.p,null,s.a.createElement(l.f,null,s.a.createElement(l.A,null,s.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),s.a.createElement(l.y,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),s.a.createElement(l.e,{class:"settings-content",scrollX:!1,scrollY:!1,fullscreen:!0},s.a.createElement(l.m,{lines:"none"},s.a.createElement(l.n,null,s.a.createElement(l.k,null,"Settings")),s.a.createElement(l.j,{class:"spacer"}),s.a.createElement(l.j,null,s.a.createElement(l.k,null,"Units"),s.a.createElement(l.t,{value:c.settings.units,onIonChange:function(e){var t=e.target.value;re.updateUnits(t).then((function(){i({type:x,payload:t})}))}},s.a.createElement(l.u,{value:n.C},"\xb0C"),s.a.createElement(l.u,{value:n.F},"\xb0F"))),s.a.createElement(l.j,null,s.a.createElement(l.k,null,"Set Point Step"),s.a.createElement(l.i,{inputMode:"numeric",value:T.toFixed(0),type:"number",min:"1",max:"10",onIonChange:function(e){var t=parseInt(e.target.value);Object(ae.isNumber)(t)&&t>0&&t<=10&&i({type:N,payload:t})},disabled:c.updating})),s.a.createElement(l.j,null,s.a.createElement(l.k,null,"Booster Step"),s.a.createElement(l.i,{inputMode:"numeric",value:R.toFixed(0),type:"number",min:"1",max:"5",onIonChange:function(e){var t=parseInt(e.target.value);Object(ae.isNumber)(t)&&t>0&&t<=5&&i({type:A,payload:t})},disabled:c.updating})),s.a.createElement(l.j,null,s.a.createElement(l.k,null,"Vibration"),s.a.createElement(l.z,{checked:d,onIonChange:function(e){if(!c.updating){var t=1===(1&c.craftySettings);if(d!==t){var a=2&c.craftySettings|(t?0:1);console.log("updating settings: ".concat(a)),re.updateCraftySettings(a).then((function(){i({type:O,payload:a}),h(!d)}))}}},disabled:c.updating})),s.a.createElement(l.j,null,s.a.createElement(l.k,null,"Charge Indicator"),s.a.createElement(l.z,{checked:b,onIonChange:function(e){if(!c.updating){var t=2===(2&c.craftySettings);if(b!==t){var a=1&c.craftySettings|(t?0:2);console.log("updating settings: ".concat(a)),re.updateCraftySettings(a).then((function(){i({type:O,payload:a}),g(!b)})).catch((function(e){i({type:O,payload:c.craftySettings}),console.log("Error updating characteristic.")}))}}},disabled:c.updating})),s.a.createElement(l.j,null,s.a.createElement(l.s,{class:"led-item"},s.a.createElement(l.k,null,"LED Brightness"),s.a.createElement(l.q,{min:0,max:100,value:j,onIonChange:function(e){if(!c.updating){var a=e.target.value;t=a,C(a),a!==c.led&&setTimeout((function(){console.log("LED: ".concat(a," ? ").concat(t)),a===t&&re.updateLED(a).then((function(){i({type:w,payload:a})}))}),500)}},step:5}))),s.a.createElement(l.j,{class:"spacer"})))):s.a.createElement(o.a,{to:"/connect"})}),de=(a(303),function(){var e=Object(r.useContext)(Y).state;return e.connected?s.a.createElement(l.p,null,s.a.createElement(l.f,null,s.a.createElement(l.A,null,s.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),s.a.createElement(l.y,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),s.a.createElement(l.e,{class:"info-content",scrollX:!1,scrollY:!1,fullscreen:!0},s.a.createElement(l.m,{lines:"none"},s.a.createElement(l.n,null,s.a.createElement(l.k,null,"Information")),s.a.createElement(l.j,{class:"spacer"}),s.a.createElement(l.j,null,s.a.createElement(l.k,{className:"label"},"Serial #:"),s.a.createElement(l.k,{className:"value"},e.info.serial.substr(0,8))),s.a.createElement(l.j,null,s.a.createElement(l.k,{className:"label"},"Model:"),s.a.createElement(l.k,{className:"value"},e.info.model)),s.a.createElement(l.j,null,s.a.createElement(l.k,{className:"label"},"Version:"),s.a.createElement(l.k,{className:"value"},e.info.version)),s.a.createElement(l.j,null,s.a.createElement(l.k,{className:"label"},"Hours:"),s.a.createElement(l.k,{className:"value"},e.info.hoursOfOperation)),s.a.createElement(l.j,{class:"spacer"})))):s.a.createElement(o.a,{to:"/connect"})}),he=(a(304),a(305),a(306),a(307),a(308),a(309),a(310),a(311),a(312),a(313),a(314),function(){var e=Object(r.useContext)(Y).state;return s.a.createElement(l.c,null,s.a.createElement(u.a,null,s.a.createElement(l.x,null,s.a.createElement(l.r,null,s.a.createElement(o.b,{path:"/connect",component:ce,exact:!0}),s.a.createElement(o.b,{path:"/home",component:ue,exact:!0}),s.a.createElement(o.b,{path:"/settings",component:pe,exact:!0}),s.a.createElement(o.b,{path:"/info",component:de,exact:!0}),s.a.createElement(o.b,{path:"/",render:function(){return s.a.createElement(o.a,{to:"/connect"})},exact:!0})),s.a.createElement(l.v,{slot:"bottom"},s.a.createElement(l.w,{tab:"home",href:"/home",disabled:!e.connected},s.a.createElement(l.g,{icon:p.a}),s.a.createElement(l.k,null,"Temperature")),s.a.createElement(l.w,{tab:"settings",href:"/settings",disabled:!e.connected},s.a.createElement(l.g,{icon:d.a}),s.a.createElement(l.k,null,"Settings")),s.a.createElement(l.w,{tab:"info",href:"/info",disabled:!e.connected},s.a.createElement(l.g,{icon:h.a}),s.a.createElement(l.k,null,"Information"))))))}),me=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(s.a.createElement((function(e){var t=s.a.useReducer(B,I),a=Object(m.a)(t,2),n={state:a[0],dispatch:a[1]};return s.a.createElement(Y.Provider,{value:n},e.children)}),null,s.a.createElement(he,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("https://github.cataford.com/crafty",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("https://github.cataford.com/crafty","/service-worker.js");me?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):fe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):fe(t,e)}))}}()}},[[185,9,10]]]);
//# sourceMappingURL=main.abca0838.chunk.js.map