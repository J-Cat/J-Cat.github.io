(this["webpackJsonpcrafty-control"]=this["webpackJsonpcrafty-control"]||[]).push([[8],{153:function(e){e.exports=JSON.parse('{"name":"crafty-control","version":"1.0.5-beta","private":true,"dependencies":{"@ionic/react":"^4.11.0","@ionic/react-router":"^4.11.0","@types/jest":"^24.0.18","@types/node":"^12.7.12","@types/react":"^16.9.5","@types/react-dom":"^16.9.1","@types/react-router":"^5.1.1","@types/react-router-dom":"^5.1.0","babel-polyfill":"^6.26.0","date-fns":"^2.8.1","ionicons":"^4.6.3","react":"^16.10.2","react-app-polyfill":"^1.0.5","react-dom":"^16.10.2","react-router":"^5.1.0","react-router-dom":"^5.1.0","react-scripts":"3.2.0","react-visual-graphic":"^0.2.0","typescript":"3.6.3","typescript-task-queue":"^1.0.4"},"scripts":{"ionic:build:before":"cross-env-shell PUBLIC_URL=https://github.cataford.com/crafty/","start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version","ie >= 11"]},"description":"Crafty Control Application","devDependencies":{"@types/date-fns":"^2.6.0","@types/web-bluetooth":"0.0.4","cross-env":"^6.0.3"}}')},189:function(e,t,a){e.exports=a(319)},195:function(e,t,a){var n={"./ion-action-sheet-controller_8.entry.js":[325,43],"./ion-action-sheet-ios.entry.js":[326,44],"./ion-action-sheet-md.entry.js":[327,45],"./ion-alert-ios.entry.js":[328,24],"./ion-alert-md.entry.js":[329,25],"./ion-app_8-ios.entry.js":[330,11],"./ion-app_8-md.entry.js":[331,12],"./ion-avatar_3-ios.entry.js":[332,46],"./ion-avatar_3-md.entry.js":[333,47],"./ion-back-button-ios.entry.js":[334,48],"./ion-back-button-md.entry.js":[335,49],"./ion-backdrop-ios.entry.js":[336,81],"./ion-backdrop-md.entry.js":[337,82],"./ion-button_2-ios.entry.js":[338,50],"./ion-button_2-md.entry.js":[339,51],"./ion-card_5-ios.entry.js":[340,52],"./ion-card_5-md.entry.js":[341,53],"./ion-checkbox-ios.entry.js":[342,54],"./ion-checkbox-md.entry.js":[343,55],"./ion-chip-ios.entry.js":[344,56],"./ion-chip-md.entry.js":[345,57],"./ion-col_3.entry.js":[346,83],"./ion-datetime_3-ios.entry.js":[347,20],"./ion-datetime_3-md.entry.js":[348,21],"./ion-fab_3-ios.entry.js":[349,58],"./ion-fab_3-md.entry.js":[350,59],"./ion-img.entry.js":[351,84],"./ion-infinite-scroll_2-ios.entry.js":[352,39],"./ion-infinite-scroll_2-md.entry.js":[353,40],"./ion-input-ios.entry.js":[354,60],"./ion-input-md.entry.js":[355,61],"./ion-item-option_3-ios.entry.js":[356,62],"./ion-item-option_3-md.entry.js":[357,63],"./ion-item_8-ios.entry.js":[358,64],"./ion-item_8-md.entry.js":[359,65],"./ion-loading-ios.entry.js":[360,26],"./ion-loading-md.entry.js":[361,27],"./ion-menu_4-ios.entry.js":[362,18],"./ion-menu_4-md.entry.js":[363,19],"./ion-modal-ios.entry.js":[364,14],"./ion-modal-md.entry.js":[365,15],"./ion-nav_5.entry.js":[366,13],"./ion-popover-ios.entry.js":[367,16],"./ion-popover-md.entry.js":[368,17],"./ion-progress-bar-ios.entry.js":[369,66],"./ion-progress-bar-md.entry.js":[370,67],"./ion-radio_2-ios.entry.js":[371,32],"./ion-radio_2-md.entry.js":[372,33],"./ion-range-ios.entry.js":[373,68],"./ion-range-md.entry.js":[374,69],"./ion-refresher_2-ios.entry.js":[375,41],"./ion-refresher_2-md.entry.js":[376,42],"./ion-reorder_2-ios.entry.js":[377,37],"./ion-reorder_2-md.entry.js":[378,38],"./ion-ripple-effect.entry.js":[379,85],"./ion-route_4.entry.js":[380,70],"./ion-searchbar-ios.entry.js":[381,28],"./ion-searchbar-md.entry.js":[382,29],"./ion-segment_2-ios.entry.js":[383,71],"./ion-segment_2-md.entry.js":[384,72],"./ion-select_3-ios.entry.js":[385,34],"./ion-select_3-md.entry.js":[386,35],"./ion-slide_2-ios.entry.js":[387,86],"./ion-slide_2-md.entry.js":[388,87],"./ion-spinner.entry.js":[389,73],"./ion-split-pane-ios.entry.js":[390,88],"./ion-split-pane-md.entry.js":[391,89],"./ion-tab-bar_2-ios.entry.js":[392,74],"./ion-tab-bar_2-md.entry.js":[393,75],"./ion-tab_2.entry.js":[394,36],"./ion-text.entry.js":[395,76],"./ion-textarea-ios.entry.js":[396,77],"./ion-textarea-md.entry.js":[397,78],"./ion-toast-ios.entry.js":[398,30],"./ion-toast-md.entry.js":[399,31],"./ion-toggle-ios.entry.js":[400,22],"./ion-toggle-md.entry.js":[401,23],"./ion-virtual-scroll.entry.js":[402,90]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=195,e.exports=r},196:function(e,t,a){var n={"./ion-icon.entry.js":[406,98]};function r(e){if(!a.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],r=t[0];return a.e(t[1]).then((function(){return a(r)}))}r.keys=function(){return Object.keys(n)},r.id=196,e.exports=r},201:function(e,t,a){},305:function(e,t,a){},306:function(e,t,a){},307:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),c=a(69),s=a.n(c),o=a(9),l=a(1),u=a(170),d=a(412),p=a(413),m=a(414),f=a(20),h=a(41),y=a(4),b="CRAFTY/CONNECTING",g="CRAFTY/DISCONNECTED",E="CRAFTY/CONNECTED",v="CRAFTY/SET_CURRENT_TEMPERATURE",j="CRAFTY/SET_SETPOINT",w="CRAFTY/SET_BOOST",x="CRAFTY/SET_LED",C="CRAFTY/SET_BATTERY_PERCENT",S="CRAFTY/UPDATE_UNITS",O="CRAFTY/UPDATE_SETTINGS",T="CRAFTY/UPDATING",U="CRAFTY/UPDATED",k="CRAFTY/SET_SERIAL",P="CRAFTY/SET_MODEL",_="CRAFTY/SET_VERSION",N="CRAFTY/SET_HOURS_OF_OP",A="CRAFTY/SETPOINT_STEP",F="CRAFTY/BOOST_STEP",R="CRAFTY/SET_DATA",D="CRAFTY/SET_POWER_STATE";!function(e){e[e.F=0]="F",e[e.C=1]="C"}(n||(n={}));var B=localStorage.getItem("crafty-control-units"),M=localStorage.getItem("crafty-control-setpoint-step"),I=localStorage.getItem("crafty-control-boost-step"),V={settings:{units:B?parseInt(B):n.C,setPointStep:M?parseInt(M):5,boostStep:I?parseInt(I):1},info:{serial:"",model:"",version:"",hoursOfOperation:0,powerState:0,data:{}},connecting:!1,connected:!1,updating:!1,temperature:0,setPoint:0,boost:0,batteryPercent:0,craftySettings:0,led:-1},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(y.a)({},e,{connecting:!0});case E:return Object(y.a)({},e,{connecting:!1,connected:!0});case v:return Object(y.a)({},e,{temperature:t.payload});case j:return Object(y.a)({},e,{updating:!1,setPoint:t.payload});case C:return Object(y.a)({},e,{batteryPercent:t.payload});case w:return Object(y.a)({},e,{updating:!1,boost:t.payload});case x:return Object(y.a)({},e,{updating:!1,led:t.payload});case g:return Object(y.a)({},e,{connected:!1,connecting:!1});case S:return localStorage.setItem("crafty-control-units",t.payload.toString()),Object(y.a)({},e,{settings:Object(y.a)({},e.settings,{units:t.payload})});case A:return localStorage.setItem("crafty-control-setpoint-step",t.payload.toString()),Object(y.a)({},e,{settings:Object(y.a)({},e.settings,{setPointStep:t.payload})});case F:return localStorage.setItem("crafty-control-boost-step",t.payload.toString()),Object(y.a)({},e,{settings:Object(y.a)({},e.settings,{boostStep:t.payload})});case O:return Object(y.a)({},e,{updating:!1,craftySettings:t.payload});case T:return Object(y.a)({},e,{updating:!0});case U:return Object(y.a)({},e,{updating:!1});case k:return Object(y.a)({},e,{info:Object(y.a)({},e.info,{serial:t.payload})});case P:return Object(y.a)({},e,{info:Object(y.a)({},e.info,{model:t.payload})});case N:return Object(y.a)({},e,{info:Object(y.a)({},e.info,{hoursOfOperation:t.payload})});case _:return Object(y.a)({},e,{info:Object(y.a)({},e.info,{version:t.payload})});case D:return Object(y.a)({},e,{info:Object(y.a)({},e.info,{powerState:t.payload})});case R:var a=t.payload;return Object(y.a)({},e,{info:Object(y.a)({},e.info,{data:Object(y.a)({},e.info.data,Object(h.a)({},a.uuid,a))})});default:return e}},L=i.a.createContext(void 0);L.Consumer;a(201);var q=a(2),W=a.n(q),H=a(5),G={ServiceUuid:"00000001-4c45-4b43-4942-265a524f5453",TemperatureUuid:"00000011-4c45-4b43-4942-265a524f5453",SetPointUuid:"00000021-4c45-4b43-4942-265a524f5453",BoostUuid:"00000031-4c45-4b43-4942-265a524f5453",BatteryUuid:"00000041-4c45-4b43-4942-265a524f5453",LedUuid:"00000051-4c45-4b43-4942-265a524f5453",MetaDataUuid:"00000002-4c45-4b43-4942-265a524f5453",ModelUuid:"00000022-4c45-4b43-4942-265a524f5453",VersionUuid:"00000032-4c45-4b43-4942-265a524f5453",SerialUuid:"00000052-4c45-4b43-4942-265a524f5453",MiscDataUuid:"00000003-4c45-4b43-4942-265a524f5453",HoursOfOperationUuid:"00000023-4c45-4b43-4942-265a524f5453",SettingsUuid:"000001c3-4c45-4b43-4942-265a524f5453",PowerUuid:"00000063-4c45-4b43-4942-265a524f5453",Battery:{RemainingUuid:"00000153-4c45-4b43-4942-265a524f5453",TotalUuid:"00000143-4c45-4b43-4942-265a524f5453",DesignUuid:"00000183-4c45-4b43-4942-265a524f5453"},otherUuids:[{uuid:"00000153-4c45-4b43-4942-265a524f5453",label:"Battery Remaining",type:"hex",suffix:"mah",notify:!1},{uuid:"00000143-4c45-4b43-4942-265a524f5453",label:"Battery Capacity",type:"hex",suffix:"mah"},{uuid:"00000183-4c45-4b43-4942-265a524f5453",label:"Battery Design Capacity",type:"hex",suffix:"mah"},{uuid:"00000163-4c45-4b43-4942-265a524f5453",label:"Discharge Cycles",type:"hex"},{uuid:"00000173-4c45-4b43-4942-265a524f5453",label:"Charge Cycles",type:"hex"},{uuid:"00000033-4c45-4b43-4942-265a524f5453",label:"Hardware ID",type:"ascii"},{uuid:"00000053-4c45-4b43-4942-265a524f5453",label:"SN Hardware",type:"ascii"},{uuid:"00000042-4c45-4b43-4942-265a524f5453",label:"Bluetooth Address",type:"hex"},{uuid:"00000043-4c45-4b43-4942-265a524f5453",label:"PCB Version",type:"hex"},{uuid:"000000f3-4c45-4b43-4942-265a524f5453",label:"Current Temperature (PT1000)",type:"hex",suffix:"\xb0c",divider:10},{uuid:"00000103-4c45-4b43-4942-265a524f5453",label:"Adjusted Current Temperature (PT1000)",type:"hex",suffix:"\xb0c",divider:10},{uuid:"00000113-4c45-4b43-4942-265a524f5453",label:"Accu Temperature",type:"hex",suffix:"\xb0c",divider:10},{uuid:"00000123-4c45-4b43-4942-265a524f5453",label:"Accu Temperature Min",type:"hex",suffix:"\xb0c",divider:10},{uuid:"00000133-4c45-4b43-4942-265a524f5453",label:"Accu Temperature Max",type:"hex",suffix:"\xb0c",divider:10},{uuid:"00000013-4c45-4b43-4942-265a524f5453",label:"Operating Time Accu",type:"hex",suffix:"h",divider:10},{uuid:"00000073-4c45-4b43-4942-265a524f5453",label:"Accu Status Register 2",type:"hex"},{uuid:"00000083-4c45-4b43-4942-265a524f5453",label:"System Status Register 2",type:"hex"},{uuid:"00000093-4c45-4b43-4942-265a524f5453",label:"Project Status Register",type:"hex"},{uuid:"000000a3-4c45-4b43-4942-265a524f5453",label:"Charger Status Register",type:"hex"},{uuid:"000000b3-4c45-4b43-4942-265a524f5453",label:"Voltage Accu",type:"hex",suffix:"mv"},{uuid:"000000c3-4c45-4b43-4942-265a524f5453",label:"Voltage Mains",type:"hex",suffix:"mv"},{uuid:"000000d3-4c45-4b43-4942-265a524f5453",label:"Voltage Heating",type:"hex",suffix:"mv"},{uuid:"000000e3-4c45-4b43-4942-265a524f5453",label:"Current Accu",type:"hex",suffix:"ma"}]},z=a(15),J=a(173),X=new TextDecoder("utf8"),K=new function e(){var t=this;Object(H.a)(this,e),this.units=n.C,this.dispatch=void 0,this.service=void 0,this.setPointCharacteristic=void 0,this.boostCharacteristic=void 0,this.temperatureCharacteristic=void 0,this.settingsCharacteristic=void 0,this.ledCharacteristic=void 0,this.batteryCharacteristic=void 0,this.powerStateCharacteristic=void 0,this.queue=new J.TaskQueue({autorun:!0,stoppable:!1}),this.connect=function(e,a){var n,r,i,c,s;return W.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t.units=e,t.dispatch=a,o.next=4,W.a.awrap(navigator.bluetooth.requestDevice({filters:[{name:"Storz&Bickel"},{name:"STORZ&BICKEL"}],optionalServices:[G.ServiceUuid,G.MetaDataUuid,G.MiscDataUuid]}));case 4:if((n=o.sent)&&n.gatt){o.next=7;break}throw new Error("Failed to retrieve Crafty BLE device.");case 7:return n.ongattserverdisconnected=function(e){a({type:g})},t.dispatch({type:b}),o.next=11,W.a.awrap(n.gatt.connect());case 11:if(r=o.sent){o.next=14;break}throw new Error("Failed to retrieve BLE server.");case 14:return o.next=16,W.a.awrap(r.getPrimaryService(G.ServiceUuid));case 16:return i=o.sent,o.next=19,W.a.awrap(r.getPrimaryService(G.MetaDataUuid));case 19:return c=o.sent,o.next=22,W.a.awrap(r.getPrimaryService(G.MiscDataUuid));case 22:if(s=o.sent,i){o.next=25;break}throw new Error("Failed to retrieve primary data service.");case 25:if(c){o.next=27;break}throw new Error("Failed to retrieve metadata service.");case 27:if(s){o.next=29;break}throw new Error("Failed to retrieve miscellaneous data service.");case 29:return o.next=31,W.a.awrap(t.getDataServiceCharacteristics(i));case 31:return o.next=33,W.a.awrap(t.getMetaDataCharacteristics(c));case 33:return o.next=35,W.a.awrap(t.getMiscCharacteristics(s));case 35:return o.next=37,W.a.awrap(t.getOtherCharacteristics(i));case 37:return o.next=39,W.a.awrap(t.getOtherCharacteristics(c));case 39:return o.next=41,W.a.awrap(t.getOtherCharacteristics(s));case 41:return o.next=43,W.a.awrap(t.bindCharacteristics(c,s));case 43:t.dispatch({type:E});case 44:case"end":return o.stop()}}))},this.bindCharacteristics=function(e,a){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return t.temperatureCharacteristic.oncharacteristicvaluechanged=function(e){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:t.queue.enqueue((function(){var e;return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,W.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 2:(e=a.sent)&&Object(z.isNumber)(e)&&t.dispatch({type:v,payload:e});case 4:case"end":return a.stop()}}))}));case 1:case"end":return e.stop()}}))},t.batteryCharacteristic.oncharacteristicvaluechanged=function(e){return W.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:t.queue.enqueue((function(){var e,a;return W.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,W.a.awrap(t.batteryCharacteristic.readValue());case 2:(e=n.sent)&&(a=e.getUint16(0,!0))&&Object(z.isNumber)(a)&&t.dispatch({type:C,payload:a});case 4:case"end":return n.stop()}}))}));case 1:case"end":return e.stop()}}))},t.temperatureCharacteristic.startNotifications(),t.batteryCharacteristic.startNotifications(),e.abrupt("return");case 5:case"end":return e.stop()}}))},this.getDataServiceCharacteristics=function(e){var a,n,r,i,c,s,o;return W.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,W.a.awrap(e.getCharacteristic(G.TemperatureUuid));case 2:if(t.temperatureCharacteristic=l.sent,t.temperatureCharacteristic){l.next=5;break}throw new Error("Failed to retrieve temperature characteristic.");case 5:return l.next=7,W.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 7:return a=l.sent,t.dispatch({type:v,payload:a}),l.next=11,W.a.awrap(e.getCharacteristic(G.SetPointUuid));case 11:if(t.setPointCharacteristic=l.sent,t.setPointCharacteristic){l.next=14;break}throw new Error("Failed to retrieve setpoint characteristic.");case 14:return l.next=16,W.a.awrap(t.readTemp(t.units,t.setPointCharacteristic,0));case 16:return(n=l.sent)&&Object(z.isNumber)(n)&&t.dispatch({type:j,payload:n}),l.next=20,W.a.awrap(e.getCharacteristic(G.BoostUuid));case 20:if(t.boostCharacteristic=l.sent,t.boostCharacteristic){l.next=23;break}throw new Error("Failed to retrieve the boost characteristic.");case 23:return l.next=25,W.a.awrap(t.readTemp(t.units,t.boostCharacteristic,0));case 25:return(r=l.sent)&&Object(z.isNumber)(r)&&t.dispatch({type:w,payload:r}),l.next=29,W.a.awrap(e.getCharacteristic(G.LedUuid));case 29:return t.ledCharacteristic=l.sent,l.next=32,W.a.awrap(t.ledCharacteristic.readValue());case 32:return(i=l.sent)&&(c=i.getUint16(0,!0))&&Object(z.isNumber)(c)&&t.dispatch({type:x,payload:c}),l.next=36,W.a.awrap(e.getCharacteristic(G.BatteryUuid));case 36:if(t.batteryCharacteristic=l.sent,t.batteryCharacteristic){l.next=39;break}throw new Error("Failed to retrieve the battery characteristic.");case 39:return l.next=41,W.a.awrap(t.batteryCharacteristic.readValue());case 41:(s=l.sent)&&(o=s.getUint16(0,!0))&&Object(z.isNumber)(o)&&t.dispatch({type:C,payload:o});case 43:case"end":return l.stop()}}))},this.getMiscCharacteristics=function(e){var a,n,r,i,c,s,o;return W.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,W.a.awrap(e.getCharacteristic(G.SettingsUuid));case 2:if(t.settingsCharacteristic=l.sent,t.settingsCharacteristic){l.next=5;break}throw new Error("Failed to retrieve settings characteristic.");case 5:return l.next=7,W.a.awrap(t.settingsCharacteristic.readValue());case 7:return(a=l.sent)&&(n=a.getUint16(0,!0))&&Object(z.isNumber)(n)&&t.dispatch({type:O,payload:n}),l.next=11,W.a.awrap(e.getCharacteristic(G.HoursOfOperationUuid));case 11:if(r=l.sent){l.next=14;break}throw new Error("Failed to retrieve hours of operation characteristic.");case 14:return l.next=16,W.a.awrap(r.readValue());case 16:return(i=l.sent)&&(c=i.getUint16(0,!0))&&Object(z.isNumber)(c)&&t.dispatch({type:N,payload:c}),l.next=20,W.a.awrap(e.getCharacteristic(G.PowerUuid));case 20:if(t.powerStateCharacteristic=l.sent,t.powerStateCharacteristic){l.next=23;break}throw new Error("Failed to retrieve the power state characteristic.");case 23:return l.next=25,W.a.awrap(t.powerStateCharacteristic.readValue());case 25:(s=l.sent)&&(o=s.getUint16(0,!0))&&Object(z.isNumber)(o)&&t.dispatch({type:D,payload:o});case 27:case"end":return l.stop()}}))},this.getMetaDataCharacteristics=function(e){var a,n,r,i,c,s,o,l,u;return W.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,W.a.awrap(e.getCharacteristic(G.SerialUuid));case 2:if(a=d.sent){d.next=5;break}throw new Error("Failed to retrieve the serial # characteristic.");case 5:return d.next=7,W.a.awrap(a.readValue());case 7:return(n=d.sent)&&(r=X.decode(n.buffer))&&t.dispatch({type:k,payload:r}),d.next=11,W.a.awrap(e.getCharacteristic(G.ModelUuid));case 11:if(i=d.sent){d.next=14;break}throw new Error("Failed to retrieve the model # characteristic.");case 14:return d.next=16,W.a.awrap(i.readValue());case 16:return(c=d.sent)&&(s=X.decode(c.buffer))&&t.dispatch({type:P,payload:s}),d.next=20,W.a.awrap(e.getCharacteristic(G.VersionUuid));case 20:if(o=d.sent){d.next=23;break}throw new Error("Failed to retrieve the version # characteristic.");case 23:return d.next=25,W.a.awrap(o.readValue());case 25:(l=d.sent)&&(u=X.decode(l.buffer))&&t.dispatch({type:_,payload:u});case 27:case"end":return d.stop()}}))},this.getOtherCharacteristics=function(e){var a,n,r,i,c,s,o,l,u,d,p;return W.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:a=!0,n=!1,r=void 0,m.prev=3,i=G.otherUuids[Symbol.iterator]();case 5:if(a=(c=i.next()).done){m.next=26;break}if((s=c.value).uuid.substring(7)!==e.uuid.substring(7)){m.next=23;break}return m.next=10,W.a.awrap(e.getCharacteristic(s.uuid));case 10:if(!(o=m.sent)){m.next=23;break}if("hex"!==s.type){m.next=19;break}return m.next=15,W.a.awrap(o.readValue());case 15:(l=m.sent)&&(u=l.getUint16(0,!0))&&Object(z.isNumber)(u)&&t.dispatch({type:R,payload:Object(y.a)({},s,{value:u})}),m.next=23;break;case 19:return m.next=21,W.a.awrap(o.readValue());case 21:(d=m.sent)&&(p=X.decode(d.buffer))&&t.dispatch({type:R,payload:Object(y.a)({},s,{value:p})});case 23:a=!0,m.next=5;break;case 26:m.next=32;break;case 28:m.prev=28,m.t0=m.catch(3),n=!0,r=m.t0;case 32:m.prev=32,m.prev=33,a||null==i.return||i.return();case 35:if(m.prev=35,!n){m.next=38;break}throw r;case 38:return m.finish(35);case 39:return m.finish(32);case 40:case"end":return m.stop()}}),null,null,[[3,28,32,40],[33,,35,39]])},this.updateSetPoint=function(e){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.dispatch({type:T}),t.setPointCharacteristic){a.next=4;break}throw new Error("Failed to retrieve BLE Crafty Set Point Characteristic.");case 4:return a.next=6,W.a.awrap(t.writeTemp(t.units,t.setPointCharacteristic,e));case 6:t.dispatch({type:j,payload:e});case 7:return a.prev=7,t.dispatch({type:U}),a.finish(7);case 10:case"end":return a.stop()}}),null,null,[[0,,7,10]])}));case 1:case"end":return a.stop()}}))},this.updateBoost=function(e){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,t.dispatch({type:T}),t.boostCharacteristic){a.next=4;break}throw new Error("Failed to retrieve BLE Crafty Boost Characteristic.");case 4:return a.next=6,W.a.awrap(t.writeTemp(t.units,t.boostCharacteristic,e));case 6:t.dispatch({type:w,payload:e});case 7:return a.prev=7,t.dispatch({type:U}),a.finish(7);case 10:case"end":return a.stop()}}),null,null,[[0,,7,10]])}));case 1:case"end":return a.stop()}}))},this.updateLED=function(e){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){var a,n;return W.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t.dispatch({type:T}),t.ledCharacteristic){r.next=4;break}throw new Error("Failed to retrieve BLE Crafty LED Brightness Characteristic.");case 4:return a=new ArrayBuffer(2),(n=new DataView(a)).setUint16(0,e,!0),r.next=10,W.a.awrap(t.ledCharacteristic.writeValue(n));case 10:return r.prev=10,t.dispatch({type:U}),r.finish(10);case 13:case"end":return r.stop()}}),null,null,[[0,,10,13]])}));case 1:case"end":return a.stop()}}))},this.settingUpdating=!1,this.updateCraftySettings=function(e){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.settingUpdating){a.next=2;break}return a.abrupt("return");case 2:t.queue.enqueue((function(){var a,n;return W.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t.settingUpdating=!0,t.dispatch({type:T}),t.settingsCharacteristic){r.next=5;break}throw new Error("Failed to retrieve BLE Crafty Settings Characteristic.");case 5:return a=new ArrayBuffer(2),(n=new DataView(a)).setUint16(0,e,!0),r.next=10,W.a.awrap(t.settingsCharacteristic.writeValue(n));case 10:return r.prev=10,t.settingUpdating=!1,t.dispatch({type:U}),r.finish(10);case 14:case"end":return r.stop()}}),null,null,[[0,,10,14]])}));case 3:case"end":return a.stop()}}))},this.writeTemp=function(e,t,a){var r,i,c;return W.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return r=a,r=e===n.F?Math.round((r-32)/.18):Math.round(r/.1),i=new ArrayBuffer(2),(c=new DataView(i)).setUint16(0,r,!0),s.next=7,W.a.awrap(t.writeValue(c));case 7:case"end":return s.stop()}}))},this.readTemp=function(e,t){var a,r,i,c=arguments;return W.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=c.length>2&&void 0!==c[2]?c[2]:1,s.next=3,W.a.awrap(t.readValue());case 3:if(!(r=s.sent)){s.next=10;break}return i=r.getUint16(0,!0),i=e===n.F?Math.round((.18*i+32)*Math.pow(10,a))/Math.pow(10,a):Math.round(.1*i*Math.pow(10,a))/Math.pow(10,a),s.abrupt("return",i);case 10:throw new Error("Failed to read temperature value.");case 11:case"end":return s.stop()}}))},this.updateUnits=function(e){return W.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:t.queue.enqueue((function(){var a;return W.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t.units=e,n.next=4,W.a.awrap(t.readTemp(t.units,t.temperatureCharacteristic));case 4:return(a=n.sent)&&Object(z.isNumber)(a)&&t.dispatch({type:v,payload:a}),n.next=8,W.a.awrap(t.readTemp(t.units,t.setPointCharacteristic));case 8:return(a=n.sent)&&Object(z.isNumber)(a)&&t.dispatch({type:j,payload:a}),n.next=12,W.a.awrap(t.readTemp(t.units,t.boostCharacteristic));case 12:(a=n.sent)&&Object(z.isNumber)(a)&&t.dispatch({type:w,payload:a});case 14:return n.prev=14,t.dispatch({type:U}),n.finish(14);case 17:case"end":return n.stop()}}),null,null,[[0,,14,17]])}));case 1:case"end":return a.stop()}}))}},Q=a(153).version,Z=function(e){var t=e.history,a=Object(r.useContext)(L),n=a.state,c=a.dispatch,s=Object(r.useState)(!1),o=Object(f.a)(s,2),u=o[0],d=o[1],p=Object(r.useState)(""),m=Object(f.a)(p,2),h=m[0],y=m[1];return i.a.createElement(l.r,null,i.a.createElement(l.m,{class:"connect-version-label"},Q),i.a.createElement(l.f,null,i.a.createElement(l.C,null,i.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),i.a.createElement(l.A,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),i.a.createElement(l.e,{class:"content",scrollX:!1,scrollY:!1,fullscreen:!0},i.a.createElement(l.o,{lines:"none"},i.a.createElement(l.p,null,i.a.createElement(l.m,null,"Connect")),i.a.createElement(l.j,{class:"spacer"}),i.a.createElement(l.j,{onClick:function(){K.connect(n.settings.units,c).then((function(){t.push("/home")})).catch((function(e){c({type:g}),y(e),d(!0)}))},hidden:n.connecting||n.connected},i.a.createElement(l.d,{size:"large"},"Connect to Crafty")),i.a.createElement(l.j,{class:"spacer"})),i.a.createElement(l.q,{message:"Connecting ...",isOpen:n.connecting})),i.a.createElement(l.b,{isOpen:u,onDidDismiss:function(){return d(!1)},header:"Error Connecting",message:h,buttons:["Ok"]}))},$=a(408),ee=a(409),te=a(410),ae=a(411),ne=(a(305),a(153).version),re=function(){var e=Object(r.useContext)(L).state,t=Object(r.useState)(-1),a=Object(f.a)(t,2),c=a[0],s=a[1],u=Object(r.useState)(!1),d=Object(f.a)(u,2),p=d[0],m=d[1];Object(r.useEffect)((function(){(c<=0||!p)&&c!==e.setPoint&&s(e.setPoint)}),[e.setPoint,p,c]);var h=function(t){var a=e.settings.units===n.C?40:104,r=e.settings.units===n.C?210:410,i=Math.floor(t);t<a?i=a:t>r&&(i=r),K.updateSetPoint(i).then((function(){i+e.settings.boostStep>r&&K.updateBoost(r-i)}))},y=function(t){var a=e.settings.units===n.C?210:410,r=Math.floor(t);r<0?r=0:e.setPoint+t>a&&(r=a-e.setPoint),K.updateBoost(r)};return e.connected?i.a.createElement(l.r,null,i.a.createElement(l.m,{class:"version-label"},ne),i.a.createElement(l.f,null,i.a.createElement(l.C,null,i.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),i.a.createElement(l.A,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"),i.a.createElement(l.g,{slot:"end",className:"power-icon",icon:32900===(32900&e.info.powerState)?$.a:32===(32&e.info.powerState)?ee.a:"",hidden:0===(32932&e.info.powerState)}))),i.a.createElement(l.e,{class:"content",scrollX:!1,scrollY:!1,fullscreen:!0},i.a.createElement(l.o,{lines:"none"},i.a.createElement(l.p,null,i.a.createElement(l.m,null,"Temperature")),i.a.createElement(l.j,{class:"spacer-home"}),i.a.createElement(l.j,{class:"temperature-item"},i.a.createElement(l.m,{class:"temperature-label"},e.temperature.toFixed(1),"\xb0",e.settings.units===n.C?"C":"F")),i.a.createElement(l.j,{class:"setpoint-item"},i.a.createElement(l.g,{class:"spacer"}),i.a.createElement(l.d,{class:"setpoint-button",onClick:function(){return h(e.setPoint-e.settings.setPointStep)}},i.a.createElement(l.g,{icon:te.a})),i.a.createElement(l.m,{class:"setpoint-input",onClick:function(){return m(!0)}},e.setPoint.toFixed(1),"\xb0",e.settings.units===n.C?"C":"F"),i.a.createElement(l.d,{class:"setpoint-button",onClick:function(){return h(e.setPoint+e.settings.setPointStep)}},i.a.createElement(l.g,{icon:ae.a})),i.a.createElement(l.g,{class:"spacer"})),i.a.createElement(l.j,null,i.a.createElement(l.g,{class:"spacer"}),i.a.createElement("svg",{width:200,height:60,className:"battery",key:e.batteryPercent},i.a.createElement("rect",{width:180,height:40,stroke:"#CCC",strokeWidth:2,x:5,y:5,rx:10,ry:10,className:"battery-container"}),i.a.createElement("rect",{width:Math.round(e.batteryPercent/100*160),height:20,x:15,y:15,rx:5,ry:5,className:"battery-gauge"}),i.a.createElement("rect",{width:10,height:20,x:185,y:15,className:"battery-button"}),i.a.createElement("text",{x:100,y:30,className:"battery-text"},e.batteryPercent.toFixed(0),"%")),i.a.createElement(l.g,{class:"spacer"})),i.a.createElement(l.j,{class:"spacer-home"}),i.a.createElement(l.j,{class:"booster"},i.a.createElement(l.u,{class:"booster-row"},i.a.createElement(l.d,{class:"booster-button",onClick:function(){return y(e.boost-e.settings.boostStep)}},i.a.createElement(l.g,{icon:te.a})),i.a.createElement(l.u,{class:"booster-text"},i.a.createElement(l.m,{class:"booster-title"},"Booster Temperature"),i.a.createElement(l.g,{class:"spacer"}),i.a.createElement(l.m,{class:"booster-value"},"+",e.boost," \xb0",e.settings.units===n.C?"C":"F")),i.a.createElement(l.d,{class:"booster-button",onClick:function(){return y(e.boost+e.settings.boostStep)}},i.a.createElement(l.g,{icon:ae.a})))))),i.a.createElement(l.b,{isOpen:p,onDidDismiss:function(){return m(!1)},header:"Set Point",message:"Please enter a new set point value",inputs:[{name:"setPoint",label:"Set Point",type:"number",value:c}],buttons:[{text:"Ok",handler:function(e){h(e.setPoint)}}]})):i.a.createElement(o.a,{to:"/connect"})},ie=(a(306),function(e){e.history;var t,a=Object(r.useContext)(L),c=a.state,s=a.dispatch,u=Object(r.useState)((function(){return 1!==(1&c.craftySettings)})),d=Object(f.a)(u,2),p=d[0],m=d[1],h=Object(r.useState)((function(){return 2!==(2&c.craftySettings)})),y=Object(f.a)(h,2),b=y[0],g=y[1],E=Object(r.useState)(-1),v=Object(f.a)(E,2),j=v[0],w=v[1],C=Object(r.useState)((function(){return c.settings.setPointStep})),T=Object(f.a)(C,2),U=T[0],k=T[1],P=Object(r.useState)((function(){return c.settings.boostStep})),_=Object(f.a)(P,2),N=_[0],R=_[1];Object(r.useEffect)((function(){var e=1!==(1&c.craftySettings);p!==e&&m(e),e=2!==(2&c.craftySettings),b!==e&&g(e),-1===j&&c.led>=0&&w(c.led),U!==c.settings.setPointStep&&k(c.settings.setPointStep),N!==c.settings.boostStep&&R(c.settings.boostStep)}),[c.craftySettings,p,b,c.led,j,U,c.settings.setPointStep,N,c.settings.boostStep]);return c.connected?i.a.createElement(l.r,null,i.a.createElement(l.f,null,i.a.createElement(l.C,null,i.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),i.a.createElement(l.A,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),i.a.createElement(l.e,{class:"settings-content",scrollX:!1,scrollY:!1,fullscreen:!0},i.a.createElement(l.o,{lines:"none"},i.a.createElement(l.p,null,i.a.createElement(l.m,null,"Settings")),i.a.createElement(l.j,{class:"spacer"}),i.a.createElement(l.j,null,i.a.createElement(l.m,null,"Units"),i.a.createElement(l.v,{value:c.settings.units,onIonChange:function(e){var t=e.target.value;K.updateUnits(t).then((function(){s({type:S,payload:t})}))}},i.a.createElement(l.w,{value:n.C},"\xb0C"),i.a.createElement(l.w,{value:n.F},"\xb0F"))),i.a.createElement(l.j,null,i.a.createElement(l.m,null,"Set Point Step"),i.a.createElement(l.i,{inputMode:"numeric",value:U.toFixed(0),type:"number",min:"1",max:"10",onIonChange:function(e){var t=parseInt(e.target.value);Object(z.isNumber)(t)&&t>0&&t<=10&&s({type:A,payload:t})},disabled:c.updating})),i.a.createElement(l.j,null,i.a.createElement(l.m,null,"Booster Step"),i.a.createElement(l.i,{inputMode:"numeric",value:N.toFixed(0),type:"number",min:"1",max:"5",onIonChange:function(e){var t=parseInt(e.target.value);Object(z.isNumber)(t)&&t>0&&t<=5&&s({type:F,payload:t})},disabled:c.updating})),i.a.createElement(l.j,null,i.a.createElement(l.m,null,"Vibration"),i.a.createElement(l.B,{checked:p,onIonChange:function(e){if(!c.updating){var t=1===(1&c.craftySettings);if(p!==t){var a=2&c.craftySettings|(t?0:1);console.log("updating settings: ".concat(a)),K.updateCraftySettings(a).then((function(){s({type:O,payload:a}),m(!p)}))}}},disabled:c.updating})),i.a.createElement(l.j,null,i.a.createElement(l.m,null,"Charge Indicator"),i.a.createElement(l.B,{checked:b,onIonChange:function(e){if(!c.updating){var t=2===(2&c.craftySettings);if(b!==t){var a=1&c.craftySettings|(t?0:2);console.log("updating settings: ".concat(a)),K.updateCraftySettings(a).then((function(){s({type:O,payload:a}),g(!b)})).catch((function(e){s({type:O,payload:c.craftySettings}),console.log("Error updating characteristic.")}))}}},disabled:c.updating})),i.a.createElement(l.j,null,i.a.createElement(l.u,{class:"led-item"},i.a.createElement(l.m,null,"LED Brightness"),i.a.createElement(l.s,{min:0,max:100,value:j,onIonChange:function(e){if(!c.updating){var a=e.target.value;t=a,w(a),a!==c.led&&setTimeout((function(){console.log("LED: ".concat(a," ? ").concat(t)),a===t&&K.updateLED(a).then((function(){s({type:x,payload:a})}))}),500)}},step:5}))),i.a.createElement(l.j,{class:"spacer"})))):i.a.createElement(o.a,{to:"/connect"})}),ce=(a(307),function(){var e=Object(r.useContext)(L).state;return e.connected?i.a.createElement(l.r,null,i.a.createElement(l.f,null,i.a.createElement(l.C,null,i.a.createElement(l.h,{slot:"start",src:"".concat("https://github.cataford.com/crafty","/assets/icon/favicon.png"),style:{width:40,height:40,margin:8}}),i.a.createElement(l.A,{style:{textAlign:"center",paddingRight:56}},"Crafty Control"))),i.a.createElement(l.e,{class:"info-content",scrollY:!0},i.a.createElement(l.o,{lines:"none"},i.a.createElement(l.p,null,i.a.createElement(l.m,null,"Information")),i.a.createElement(l.j,{class:"spacer"}),i.a.createElement(l.l,null,i.a.createElement(l.k,null,i.a.createElement(l.m,null,"General")),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Serial #:"),i.a.createElement(l.m,{className:"value"},e.info.serial.substr(0,8))),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Model:"),i.a.createElement(l.m,{className:"value"},e.info.model)),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Version:"),i.a.createElement(l.m,{className:"value"},e.info.version)),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Hours:"),i.a.createElement(l.m,{className:"value"},e.info.hoursOfOperation))),i.a.createElement(l.l,null,i.a.createElement(l.k,null,i.a.createElement(l.m,null,"Battery")),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Remaining:"),i.a.createElement(l.m,{className:"value"},e.info.data[G.Battery.RemainingUuid]?e.info.data[G.Battery.RemainingUuid].value:"","mAh")),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Capacity:"),i.a.createElement(l.m,{className:"value"},e.info.data[G.Battery.TotalUuid]?e.info.data[G.Battery.TotalUuid].value:"","mAh")),i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},"Design:"),i.a.createElement(l.m,{className:"value"},e.info.data[G.Battery.DesignUuid]?e.info.data[G.Battery.DesignUuid].value:"","mAh"))),i.a.createElement(l.l,null,i.a.createElement(l.k,null,i.a.createElement(l.m,null,"Miscellaneous")),Object.keys(e.info.data).filter((function(t){return!e.info.data[t].label.startsWith("Battery")})).map((function(t){var a=e.info.data[t];return i.a.createElement(l.j,null,i.a.createElement(l.m,{className:"label"},a.label),i.a.createElement(l.m,{className:"value"},("hex"===a.type?(a.value/(a.divider||1)).toFixed(Math.floor((a.divider||0)/10)):a.value)+(a.suffix||"")))}))),i.a.createElement(l.j,{class:"spacer"})))):i.a.createElement(o.a,{to:"/connect"})}),se=(a(308),a(309),a(310),a(311),a(312),a(313),a(314),a(315),a(316),a(317),a(318),function(){var e=Object(r.useContext)(L).state;return i.a.createElement(l.c,null,i.a.createElement(u.a,null,i.a.createElement(l.z,null,i.a.createElement(l.t,null,i.a.createElement(o.b,{path:"/connect",component:Z,exact:!0}),i.a.createElement(o.b,{path:"/home",component:re,exact:!0}),i.a.createElement(o.b,{path:"/settings",component:ie,exact:!0}),i.a.createElement(o.b,{path:"/info",component:ce,exact:!0}),i.a.createElement(o.b,{path:"/",render:function(){return i.a.createElement(o.a,{to:"/connect"})},exact:!0})),i.a.createElement(l.x,{slot:"bottom"},i.a.createElement(l.y,{tab:"home",href:"/home",disabled:!e.connected},i.a.createElement(l.g,{icon:d.a}),i.a.createElement(l.m,null,"Temperature")),i.a.createElement(l.y,{tab:"settings",href:"/settings",disabled:!e.connected},i.a.createElement(l.g,{icon:p.a}),i.a.createElement(l.m,null,"Settings")),i.a.createElement(l.y,{tab:"info",href:"/info",disabled:!e.connected},i.a.createElement(l.g,{icon:m.a}),i.a.createElement(l.m,null,"Information"))))))}),oe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function le(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(i.a.createElement((function(e){var t=i.a.useReducer(Y,V),a=Object(f.a)(t,2),n={state:a[0],dispatch:a[1]};return i.a.createElement(L.Provider,{value:n},e.children)}),null,i.a.createElement(se,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("https://github.cataford.com/crafty",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("https://github.cataford.com/crafty","/service-worker.js");oe?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):le(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):le(t,e)}))}}()}},[[189,9,10]]]);
//# sourceMappingURL=main.75cb08f7.chunk.js.map