(this["webpackJsonpghostmv1-control"]=this["webpackJsonpghostmv1-control"]||[]).push([[8],{199:function(e){e.exports=JSON.parse('{"name":"ghostmv1-control","version":"1.0.17-beta","private":true,"dependencies":{"@ionic/react":"^4.11.0","@ionic/react-router":"^4.11.0","@reduxjs/toolkit":"^1.1.0","@types/jest":"^24.0.18","@types/node":"^12.7.12","@types/react":"^16.9.5","@types/react-dom":"^16.9.1","@types/react-redux":"^7.1.5","@types/react-router":"^5.1.1","@types/react-router-dom":"^5.1.0","@types/web-bluetooth":"^0.0.4","ionicons":"^4.6.3","node-sass":"^4.13.0","react":"^16.10.2","react-circular-input":"^0.1.6","react-dom":"^16.10.2","react-redux":"^7.1.3","react-router":"^5.1.0","react-router-dom":"^5.1.0","react-scripts":"3.2.0","redux":"^4.0.4","redux-devtools":"^3.5.0","redux-thunk":"^2.3.0","typescript":"3.6.3","typescript-task-queue":"^1.0.4"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"description":"An Ionic project"}')},230:function(e,t,r){e.exports=r(402)},240:function(e,t,r){var n={"./ion-action-sheet-controller_8.entry.js":[408,43],"./ion-action-sheet-ios.entry.js":[409,44],"./ion-action-sheet-md.entry.js":[410,45],"./ion-alert-ios.entry.js":[411,24],"./ion-alert-md.entry.js":[412,25],"./ion-app_8-ios.entry.js":[413,11],"./ion-app_8-md.entry.js":[414,12],"./ion-avatar_3-ios.entry.js":[415,46],"./ion-avatar_3-md.entry.js":[416,47],"./ion-back-button-ios.entry.js":[417,48],"./ion-back-button-md.entry.js":[418,49],"./ion-backdrop-ios.entry.js":[419,81],"./ion-backdrop-md.entry.js":[420,82],"./ion-button_2-ios.entry.js":[421,50],"./ion-button_2-md.entry.js":[422,51],"./ion-card_5-ios.entry.js":[423,52],"./ion-card_5-md.entry.js":[424,53],"./ion-checkbox-ios.entry.js":[425,54],"./ion-checkbox-md.entry.js":[426,55],"./ion-chip-ios.entry.js":[427,56],"./ion-chip-md.entry.js":[428,57],"./ion-col_3.entry.js":[429,83],"./ion-datetime_3-ios.entry.js":[430,20],"./ion-datetime_3-md.entry.js":[431,21],"./ion-fab_3-ios.entry.js":[432,58],"./ion-fab_3-md.entry.js":[433,59],"./ion-img.entry.js":[434,84],"./ion-infinite-scroll_2-ios.entry.js":[435,39],"./ion-infinite-scroll_2-md.entry.js":[436,40],"./ion-input-ios.entry.js":[437,60],"./ion-input-md.entry.js":[438,61],"./ion-item-option_3-ios.entry.js":[439,62],"./ion-item-option_3-md.entry.js":[440,63],"./ion-item_8-ios.entry.js":[441,64],"./ion-item_8-md.entry.js":[442,65],"./ion-loading-ios.entry.js":[443,26],"./ion-loading-md.entry.js":[444,27],"./ion-menu_4-ios.entry.js":[445,18],"./ion-menu_4-md.entry.js":[446,19],"./ion-modal-ios.entry.js":[447,14],"./ion-modal-md.entry.js":[448,15],"./ion-nav_5.entry.js":[449,13],"./ion-popover-ios.entry.js":[450,16],"./ion-popover-md.entry.js":[451,17],"./ion-progress-bar-ios.entry.js":[452,66],"./ion-progress-bar-md.entry.js":[453,67],"./ion-radio_2-ios.entry.js":[454,32],"./ion-radio_2-md.entry.js":[455,33],"./ion-range-ios.entry.js":[456,68],"./ion-range-md.entry.js":[457,69],"./ion-refresher_2-ios.entry.js":[458,41],"./ion-refresher_2-md.entry.js":[459,42],"./ion-reorder_2-ios.entry.js":[460,37],"./ion-reorder_2-md.entry.js":[461,38],"./ion-ripple-effect.entry.js":[462,85],"./ion-route_4.entry.js":[463,70],"./ion-searchbar-ios.entry.js":[464,28],"./ion-searchbar-md.entry.js":[465,29],"./ion-segment_2-ios.entry.js":[466,71],"./ion-segment_2-md.entry.js":[467,72],"./ion-select_3-ios.entry.js":[468,34],"./ion-select_3-md.entry.js":[469,35],"./ion-slide_2-ios.entry.js":[470,86],"./ion-slide_2-md.entry.js":[471,87],"./ion-spinner.entry.js":[472,73],"./ion-split-pane-ios.entry.js":[473,88],"./ion-split-pane-md.entry.js":[474,89],"./ion-tab-bar_2-ios.entry.js":[475,74],"./ion-tab-bar_2-md.entry.js":[476,75],"./ion-tab_2.entry.js":[477,36],"./ion-text.entry.js":[478,76],"./ion-textarea-ios.entry.js":[479,77],"./ion-textarea-md.entry.js":[480,78],"./ion-toast-ios.entry.js":[481,30],"./ion-toast-md.entry.js":[482,31],"./ion-toggle-ios.entry.js":[483,22],"./ion-toggle-md.entry.js":[484,23],"./ion-virtual-scroll.entry.js":[485,90]};function a(e){if(!r.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],a=t[0];return r.e(t[1]).then((function(){return r(a)}))}a.keys=function(){return Object.keys(n)},a.id=240,e.exports=a},241:function(e,t,r){var n={"./ion-icon.entry.js":[489,98]};function a(e){if(!r.o(n,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],a=t[0];return r.e(t[1]).then((function(){return r(a)}))}a.keys=function(){return Object.keys(n)},a.id=241,e.exports=a},253:function(e,t,r){},254:function(e,t,r){},257:function(e,t){},259:function(e,t){},292:function(e,t){},293:function(e,t){},401:function(e,t,r){},402:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(56),s=r.n(c),i=r(21),o=r(1),u=r.n(o),l=r(47),p=r(35),d=r(2),f=r(217),h=r(492),m=r(493),b=r(494),v=(r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(57)),w=(r(254),r(95)),x=r.n(w),y=r(13),g=r(80),j=r(8),k="battery_service",E="battery_level",C="00887766-5544-3322-1100-aabbccddeeff",O="11887766-5544-3322-1100-aabbccddeeff",S="ffeeddcc-bbaa-0011-2233-445566778899",N={uuid:"ffeeddcc-bbaa-0011-2233-445566778802",label:"Status",properties:{notify:!0,read:!0,write:!0,type:"hex"}},P={uuid:"ffeeddcc-bbaa-0011-2233-445566778804",label:"Temperatures",properties:{notify:!0,read:!0,write:!0,type:"hex"}},_={uuid:"ffeeddcc-bbaa-0011-2233-445566778805",label:"Current",properties:{notify:!0,read:!0,write:!0,type:"hex"}},L={uuid:"ffeeddcc-bbaa-0011-2233-445566778806",label:"Pairing Key",properties:{notify:!0,read:!0,write:!0,type:"hex"}},U=(r(219),r(220)),T=function(e){for(var t=new ArrayBuffer(6),r=new DataView(t),n=0;n<6;n++)r.setUint8(n,parseInt(e.substr(2*n,2),16));return r},A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r="";if(e&&e.byteLength>0)if(8===t)for(var n=0;n<e.byteLength;n++)r+=e.getUint8(n).toString(16);else if(16===t)for(var a=0;a<e.byteLength;a+=2)r+=e.getUint16(a,!1).toString(16).padStart(4,"0");return r},q=function(e){var t;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(e.readValue());case 2:return t=r.sent,r.abrupt("return",A(t));case 4:case"end":return r.stop()}}))},D=function(e){return 1===e.byteLength?e.getUint8(0):2===e.byteLength?e.getUint16(0,!0):0},V=function(e){for(var t=[],r=0;r<e.byteLength;r+=2)t.push(e.getUint16(r,!1));return t},I=function(e,t){var r,n,a,c;return u.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!(t.length<6)){s.next=2;break}return s.abrupt("return");case 2:r=new ArrayBuffer(12),n=new DataView(r),a=0;case 5:if(!(a<6)){s.next=22;break}c=t[a],s.t0=a,s.next=0===s.t0?10:1===s.t0?12:2===s.t0?14:5===s.t0?16:18;break;case 10:return c=170,s.abrupt("break",18);case 12:return c=185,s.abrupt("break",18);case 14:return c=200,s.abrupt("break",18);case 16:return c=220,s.abrupt("break",18);case 18:n.setUint16(2*a,c,!1);case 19:a++,s.next=5;break;case 22:return s.next=24,u.a.awrap(e.writeValue(n));case 24:case"end":return s.stop()}}))},z=new function e(){var t=this;Object(j.a)(this,e),this.dispatch=void 0,this.getState=void 0,this.device=void 0,this.server=void 0,this.service=void 0,this.batteryService=void 0,this.authCharacteristic=void 0,this.batteryCharacteristic=void 0,this.currentProfileCharacteristic=void 0,this.temperatureCharacteristic=void 0,this.statusCharacteristic=void 0,this.queue=new U.TaskQueue({autorun:!0,stoppable:!1}),this.initialize=function(e,r){t.dispatch=e,t.getState=r},this.initializeBle=function(e){var r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.device&&t.device.gatt){a.next=17;break}if(!e){a.next=7;break}return a.next=4,u.a.awrap(navigator.bluetooth.requestDevice({optionalServices:[S,k],acceptAllDevices:!0}));case 4:t.device=a.sent,a.next=13;break;case 7:return r=[],(n=localStorage.getItem("ghostmv1.name"))&&(r.push({name:n}),r.push({name:n.toLowerCase()}),r.push({name:n.toUpperCase()})),a.next=12,u.a.awrap(navigator.bluetooth.requestDevice({filters:[].concat(r,[{services:[O]},{services:[C]}]),optionalServices:[S,k]}));case 12:t.device=a.sent;case 13:if(t.device&&t.device.gatt){a.next=15;break}throw new Error("Failed to retrieve GhostBLE device.");case 15:t.device.name&&localStorage.setItem("ghostmv1.name",t.device.name),t.device.ongattserverdisconnected=function(e){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(t.dispatch(X("Failed to connect to Ghost MV1.  Retrying ...")));case 2:case"end":return e.stop()}}))};case 17:return a.next=19,u.a.awrap(t.dispatch($()));case 19:return a.next=21,u.a.awrap(t.device.gatt.connect());case 21:if(t.server=a.sent,t.server){a.next=24;break}throw new Error("Failed to retrieve BLE server.");case 24:return a.next=26,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),500)})));case 26:return a.next=28,u.a.awrap(t.server.getPrimaryService(S));case 28:t.service=a.sent;case 29:case"end":return a.stop()}}))},this.pair=function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.server&&t.server.connected){r.next=3;break}return r.next=3,u.a.awrap(t.initializeBle(e));case 3:return r.next=5,u.a.awrap(t.service.getCharacteristic(L.uuid));case 5:return t.authCharacteristic=r.sent,r.next=8,u.a.awrap(new Promise((function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t.authCharacteristic.addEventListener("characteristicvaluechanged",(function(r){var n,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(t.authCharacteristic.stopNotifications());case 2:if(!(n=t.authCharacteristic.value)){r.next=10;break}return a=A(n),localStorage.setItem("ghostmv1.auth",a),r.next=8,u.a.awrap(t.dispatch(Z(a)));case 8:return r.next=10,u.a.awrap(t.authCharacteristic.writeValue(T(a)));case 10:e();case 11:case"end":return r.stop()}}))})),r.next=3,u.a.awrap(t.authCharacteristic.startNotifications());case 3:return r.next=5,u.a.awrap(t.authCharacteristic.readValue());case 5:case"end":return r.stop()}}))})));case 8:return r.next=10,u.a.awrap(t.connect(e));case 10:case"end":return r.stop()}}))},this.connect=function(e){var r,n,a;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(r=localStorage.getItem("ghostmv1.auth")){c.next=3;break}throw new Error("No paired device.");case 3:if(t.server&&t.server.connected){c.next=6;break}return c.next=6,u.a.awrap(t.initializeBle(e));case 6:return c.next=8,u.a.awrap(t.service.getCharacteristic(L.uuid));case 8:if(t.authCharacteristic=c.sent,!r||""===r||12!==r.length){c.next=12;break}return c.next=12,u.a.awrap(t.authCharacteristic.writeValue(T(r)));case 12:return c.next=14,u.a.awrap(new Promise((function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t.authCharacteristic.addEventListener("characteristicvaluechanged",(function(r){var n;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(q(t.authCharacteristic));case 2:(n=r.sent)!==t.getState().ble.authKey&&(localStorage.setItem("ghostmv1.auth",n),t.dispatch(Z(n))),t.authCharacteristic.stopNotifications(),e();case 6:case"end":return r.stop()}}))})),r.next=3,u.a.awrap(t.authCharacteristic.startNotifications());case 3:return r.next=5,u.a.awrap(q(t.authCharacteristic));case 5:case"end":return r.stop()}}))})));case 14:return c.next=16,u.a.awrap(new Promise((function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(t.service.getCharacteristic(N.uuid));case 2:return t.statusCharacteristic=r.sent,t.statusCharacteristic.addEventListener("characteristicvaluechanged",(function(r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.getState().ble.updating){r.next=2;break}return r.abrupt("return");case 2:t.queue.enqueue((function(){var r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(r=t.statusCharacteristic.value)){a.next=9;break}return a.next=4,u.a.awrap(D(r));case 4:if((n=a.sent)===t.getState().ble.status){a.next=8;break}return a.next=8,u.a.awrap(t.dispatch(ee(n)));case 8:e();case 9:case"end":return a.stop()}}))}));case 3:case"end":return r.stop()}}))})),r.next=6,u.a.awrap(t.statusCharacteristic.startNotifications());case 6:return r.next=8,u.a.awrap(t.statusCharacteristic.readValue());case 8:case"end":return r.stop()}}))})));case 16:return c.next=18,u.a.awrap(new Promise((function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(t.service.getCharacteristic(_.uuid));case 2:return t.currentProfileCharacteristic=r.sent,t.currentProfileCharacteristic.addEventListener("characteristicvaluechanged",(function(r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.getState().ble.updating){r.next=2;break}return r.abrupt("return");case 2:t.queue.enqueue((function(){var r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(r=t.currentProfileCharacteristic.value)){a.next=8;break}if(n=D(r),console.log("Update profile: ".concat(n)),n===t.getState().ble.profile){a.next=7;break}return a.next=7,u.a.awrap(t.dispatch(re(n)));case 7:e();case 8:case"end":return a.stop()}}))}));case 3:case"end":return r.stop()}}))})),r.next=6,u.a.awrap(t.currentProfileCharacteristic.startNotifications());case 6:return r.next=8,u.a.awrap(t.currentProfileCharacteristic.readValue());case 8:case 9:case"end":return r.stop()}}))})));case 18:return c.next=20,u.a.awrap(new Promise((function(e){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,u.a.awrap(t.service.getCharacteristic(P.uuid));case 2:return t.temperatureCharacteristic=r.sent,t.temperatureCharacteristic.addEventListener("characteristicvaluechanged",(function(r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.getState().ble.updating){r.next=2;break}return r.abrupt("return");case 2:t.queue.enqueue((function(){var r,n,a;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(!(r=t.temperatureCharacteristic.value)){c.next=8;break}if(n=V(r),a=t.getState().ble.temperatures,!(n.length!==a.length||n.filter((function(e,t){return e!==a[t]})).length>0)){c.next=7;break}return c.next=7,u.a.awrap(t.dispatch(ae(n)));case 7:e();case 8:case"end":return c.stop()}}))}));case 3:case"end":return r.stop()}}))})),r.next=6,u.a.awrap(t.temperatureCharacteristic.startNotifications());case 6:return r.next=8,u.a.awrap(t.temperatureCharacteristic.readValue());case 8:case"end":return r.stop()}}))})));case 20:return c.next=22,u.a.awrap(t.server.getPrimaryService(k));case 22:return t.batteryService=c.sent,c.next=25,u.a.awrap(t.batteryService.getCharacteristic(E));case 25:return t.batteryCharacteristic=c.sent,c.next=28,u.a.awrap(t.batteryCharacteristic.readValue());case 28:return n=c.sent,a=D(n),c.next=32,u.a.awrap(t.dispatch(te(a)));case 32:case"end":return c.stop()}}))},this.disconnect=function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.server){e.next=28;break}return e.prev=1,e.next=4,u.a.awrap(t.pauseNotifications());case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:if(!t.authCharacteristic){e.next=11;break}return e.next=11,u.a.awrap(new Promise((function(e){try{t.authCharacteristic.removeEventListener("characteristicvaluechanged",(function(){e()}))}catch(r){e()}})));case 11:if(!t.statusCharacteristic){e.next=14;break}return e.next=14,u.a.awrap(new Promise((function(e){try{t.statusCharacteristic.removeEventListener("characteristicvaluechanged",(function(){e()}))}catch(r){e()}})));case 14:if(!t.currentProfileCharacteristic){e.next=17;break}return e.next=17,u.a.awrap(new Promise((function(e){try{t.currentProfileCharacteristic.removeEventListener("characteristicvaluechanged",(function(){e()}))}catch(r){e()}})));case 17:if(!t.temperatureCharacteristic){e.next=20;break}return e.next=20,u.a.awrap(new Promise((function(e){try{t.temperatureCharacteristic.removeEventListener("characteristicvaluechanged",(function(){e()}))}catch(r){e()}})));case 20:if(!t.server.connected){e.next=28;break}return e.prev=21,e.next=24,u.a.awrap(t.server.disconnect());case 24:e.next=28;break;case 26:e.prev=26,e.t1=e.catch(21);case 28:delete t.server;case 29:case"end":return e.stop()}}),null,null,[[1,6],[21,26]])},this.updateCurrentProfile=function(e){var r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.currentProfileCharacteristic){a.next=2;break}return a.abrupt("return");case 2:return r=e.toString(16).padStart(2,"0"),n=T(r),a.abrupt("return",new Promise((function(r){t.queue.enqueue((function(){var a;return u.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:a=0;case 1:if(!(a<5)){c.next=17;break}return c.prev=2,c.next=5,u.a.awrap(t.currentProfileCharacteristic.writeValue(n));case 5:return r(e),c.abrupt("return");case 9:return c.prev=9,c.t0=c.catch(2),console.log("Error updating profile, trying again: ".concat(c.t0)),c.next=14,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 14:a++,c.next=1;break;case 17:console.log("failed to write profile"),r(t.getState().ble.profile);case 19:case"end":return c.stop()}}),null,null,[[2,9]])}))})));case 5:case"end":return a.stop()}}))},this.updateTemperature=function(e,r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.temperatureCharacteristic){r.next=2;break}return r.abrupt("return");case 2:if(!(e.length<6)){r.next=5;break}return console.log("Tried to write invalid temperature values."),r.abrupt("return");case 5:if(0!==e.filter((function(e){return 0!==e})).length){r.next=8;break}return console.log("Tried to write all zero temperature values."),r.abrupt("return");case 8:return r.abrupt("return",new Promise((function(r){t.queue.enqueue((function(){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:n=0;case 1:if(!(n<5)){a.next=17;break}return a.prev=2,a.next=5,u.a.awrap(I(t.temperatureCharacteristic,e));case 5:return r(),a.abrupt("return");case 9:return a.prev=9,a.t0=a.catch(2),console.log("Error writing temperatures, trying again: ".concat(a.t0)),a.next=14,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 14:n++,a.next=1;break;case 17:console.log("Failed to write temperatures."),r();case 19:case"end":return a.stop()}}),null,null,[[2,9]])}))})));case 9:case"end":return r.stop()}}))},this.lock=function(){var e,r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.statusCharacteristic){a.next=2;break}return a.abrupt("return");case 2:return e=1|t.getState().ble.status,r=new ArrayBuffer(1),(n=new DataView(r)).setUint8(0,e),a.abrupt("return",new Promise((function(e){t.queue.enqueue((function(){var r;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:r=0;case 1:if(!(r<5)){a.next=17;break}return a.prev=2,a.next=5,u.a.awrap(t.statusCharacteristic.writeValue(n));case 5:return e(!0),a.abrupt("return");case 9:return a.prev=9,a.t0=a.catch(2),console.log("Error locking vaporizer, trying again: ".concat(a.t0)),a.next=14,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 14:r++,a.next=1;break;case 17:console.log("Failed to lock vaporizer."),e(!1);case 19:case"end":return a.stop()}}),null,null,[[2,9]])}))})));case 7:case"end":return a.stop()}}))},this.unlock=function(){var e,r,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.statusCharacteristic){a.next=2;break}return a.abrupt("return");case 2:return e=254&t.getState().ble.status,r=new ArrayBuffer(1),(n=new DataView(r)).setUint8(0,e),a.abrupt("return",new Promise((function(e){t.queue.enqueue((function(){var r;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:r=0;case 1:if(!(r<5)){a.next=17;break}return a.prev=2,a.next=5,u.a.awrap(t.statusCharacteristic.writeValue(n));case 5:return e(!0),a.abrupt("return");case 9:return a.prev=9,a.t0=a.catch(2),console.log("Error unlocking vaporizer, trying again: ".concat(a.t0)),a.next=14,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 14:r++,a.next=1;break;case 17:console.log("Failed to unlock vaporizer."),e(!1);case 19:case"end":return a.stop()}}),null,null,[[2,9]])}))})));case 7:case"end":return a.stop()}}))},this.pauseNotifications=function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(t.statusCharacteristic.stopNotifications());case 2:return e.next=4,u.a.awrap(t.currentProfileCharacteristic.stopNotifications());case 4:return e.next=6,u.a.awrap(t.temperatureCharacteristic.stopNotifications());case 6:case"end":return e.stop()}}))},this.startNotifications=function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(t.statusCharacteristic.startNotifications());case 2:return e.next=4,u.a.awrap(t.currentProfileCharacteristic.startNotifications());case 4:return e.next=6,u.a.awrap(t.temperatureCharacteristic.startNotifications());case 6:case"end":return e.stop()}}))}},M={connecting:!1,connected:!1,updating:!1,connectAttempts:0,locked:!1,authKey:localStorage.getItem("ghostmv1.auth")||"",status:0,battery:0,profile:0,temperatures:[170,185,200,210,220,220]},B=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(t,r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(z.connect(e));case 3:t(Q()),setTimeout((function(){t(W())}),5e3),r.next=10;break;case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return");case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},F=function(e){return function(t,r){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(z.pair(e));case 3:t(Q()),t(W()),r.next=10;break;case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return");case 10:case"end":return r.stop()}}),null,null,[[0,7]])}},K=function(e){return function(t,r){var n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!r().ble.locked){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,u.a.awrap(t(G()));case 5:return a.next=7,u.a.awrap(t(ie()));case 7:return a.next=9,u.a.awrap(z.updateCurrentProfile(e));case 9:if(!(n=a.sent)){a.next=13;break}return a.next=13,u.a.awrap(t(ne(n)));case 13:return a.prev=13,a.next=16,u.a.awrap(t(W()));case 16:return a.next=18,u.a.awrap(t(oe()));case 18:return a.finish(13);case 19:case"end":return a.stop()}}),null,null,[[0,,13,19]])}},R=function(e,t){return function(r,n){return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,!n().ble.locked){a.next=3;break}return a.abrupt("return");case 3:return a.next=5,u.a.awrap(r(G()));case 5:return a.next=7,u.a.awrap(r(ce()));case 7:return a.next=9,u.a.awrap(z.updateTemperature(e,t));case 9:return a.next=11,u.a.awrap(r(ae(e)));case 11:return a.prev=11,a.next=14,u.a.awrap(r(W()));case 14:return a.next=16,u.a.awrap(r(se()));case 16:return a.finish(11);case 17:case"end":return a.stop()}}),null,null,[[0,,11,17]])}},W=function(){return function(e,t){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(z.startNotifications());case 2:return e.next=4,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 4:case"end":return e.stop()}}))}},G=function(){return function(e,t){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(z.pauseNotifications());case 2:return e.next=4,u.a.awrap(new Promise((function(e){return setTimeout((function(){return e()}),250)})));case 4:case"end":return e.stop()}}))}},H=Object(g.b)({name:"BLE",initialState:M,reducers:{startUpdate:function(e,t){return Object(y.a)({},e,{updating:!0})},completeUpdate:function(e,t){return Object(y.a)({},e,{updating:!1})},startUpdateProfile:function(e,t){return Object(y.a)({},e,{updating:!0})},completeUpdateProfile:function(e,t){return Object(y.a)({},e,{updating:!1})},connectStart:function(e,t){return Object(y.a)({},e,{connecting:!0,connected:!1,error:void 0,connectAttempts:e.connectAttempts+1})},connectSuccess:function(e,t){return Object(y.a)({},e,{connecting:!1,connected:!0,error:void 0})},connectFailed:function(e,t){return Object(y.a)({},e,{connecting:!1,connected:!1,error:t.payload})},disconnected:function(e,t){return Object(y.a)({},e,{connecting:!1,connected:!1,error:void 0,connectAttempts:0})},setAuthKey:function(e,t){return Object(y.a)({},e,{authKey:t.payload})},setStatus:function(e,t){return Object(y.a)({},e,{status:t.payload,locked:1===(1&t.payload)})},setBatteryLevel:function(e,t){return Object(y.a)({},e,{battery:t.payload})},setCurrentProfileForce:function(e,t){return Object(y.a)({},e,{profile:t.payload})},setCurrentProfile:function(e,t){return e.updating?e:Object(y.a)({},e,{profile:t.payload})},setTemperatures:function(e,t){return Object(y.a)({},e,{temperatures:t.payload})},clearError:function(e,t){return Object(y.a)({},e,{error:void 0})},requestLock:function(e,t){return Object(y.a)({},e,{updating:!0,locking:!0})},requestUnlock:function(e,t){return Object(y.a)({},e,{updating:!0,locking:!0})},completeLock:function(e,t){return Object(y.a)({},e,{updating:!1,locking:!1,locked:!0})},completeUnlock:function(e,t){return Object(y.a)({},e,{updating:!1,locking:!1,locked:!1})}}}),J=H.actions,$=J.connectStart,Q=J.connectSuccess,X=J.connectFailed,Y=J.disconnected,Z=J.setAuthKey,ee=J.setStatus,te=J.setBatteryLevel,re=J.setCurrentProfile,ne=J.setCurrentProfileForce,ae=J.setTemperatures,ce=(J.clearError,J.startUpdate),se=J.completeUpdate,ie=J.startUpdateProfile,oe=J.completeUpdateProfile,ue=J.requestLock,le=J.requestUnlock,pe=J.completeLock,de=J.completeUnlock,fe=H.reducer,he=r(491),me=["Low","Medium","High","F1","F2","Concentrates"],be=r(199).version,ve=function(e){var t=Object(i.c)((function(e){return e.ble.temperatures})),r=Object(i.c)((function(e){return e.ble.profile})),c=Object(i.c)((function(e){return e.ble.updating})),s=Object(i.c)((function(e){return e.ble.battery})),o=Object(i.c)((function(e){return 1===(1&e.ble.status)})),p=Object(i.b)(),f=Object(n.useState)(-1),h=Object(l.a)(f,2),m=h[0],b=h[1],w=Object(n.useState)(!1),y=Object(l.a)(w,2),g=y[0],j=y[1],k=Object(n.createRef)(),E=Object(n.useRef)(0),C=Object(n.useCallback)((function(e){var n=[].concat(Object(v.a)(t.slice(0,r-1)),[e],Object(v.a)(t.slice(r)));p(R(n,r))}),[t,r,p]);Object(n.useEffect)((function(){k.current&&k.current.lockSwipes(c)}),[c]),Object(n.useEffect)((function(){if(k&&k.current&&r>0)try{k.current&&k.current.getActiveIndex().then((function(e){r!==e+1&&r>0&&k.current&&k.current.slideTo(r-1)}))}catch(e){console.log(e)}}),[r]);var O={allowSlideNext:!c,allowSlidePrev:!c,initialSlide:r>0?r-1:0,slidesPerView:3,centeredSlides:!0,coverflowEffect:{rotate:50,stretch:0,depth:100,modifier:1,slideShadows:!0},on:{beforeInit:function(){this.classNames.push("".concat(this.params.containerModifierClass,"coverflow")),this.classNames.push("".concat(this.params.containerModifierClass,"3d")),this.params.watchSlidesProgress=!0,this.originalParams.watchSlidesProgress=!0},setTranslate:function(){for(var e=this.width,t=this.height,r=this.slides,n=this.$wrapperEl,a=this.slidesSizesGrid,c=this.params.coverflowEffect,s=this.isHorizontal(),i=this.translate,o=s?e/2-i:t/2-i,u=s?c.rotate:-c.rotate,l=c.depth,p=0,d=r.length;p<d;p+=1){var f=r.eq(p),h=a[p],m=(o-f[0].swiperSlideOffset-h/2)/h*c.modifier,b=s?u*m:0,v=s?0:u*m,w=-l*Math.abs(m),x=s?0:c.stretch*m,y=s?c.stretch*m:0;Math.abs(y)<.001&&(y=0),Math.abs(x)<.001&&(x=0),Math.abs(w)<.001&&(w=0),Math.abs(b)<.001&&(b=0),Math.abs(v)<.001&&(v=0);var g="translate3d(".concat(y,"px,").concat(x,"px,").concat(w,"px)  rotateX(").concat(v,"deg) rotateY(").concat(b,"deg)");f.transform(g),f[0].style.zIndex=1-Math.abs(Math.round(m))}(this.support.pointerEvents||this.support.prefixedPointerEvents)&&(n[0].style.perspectiveOrigin="".concat(o,"px 50%"))},setTransition:function(e){this.slides.transition(e).find(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").transition(e)}}};return a.a.createElement(d.o,{className:"dashboard"},a.a.createElement(d.k,{class:"version-label"},be),a.a.createElement(d.g,{className:"dashboard-header"},a.a.createElement(d.w,{className:"dashboard-header-toolbar"},a.a.createElement("div",{slot:"start",className:"dashboard-header-toolbar-battery-icon"},a.a.createElement("svg",{width:42,height:18,className:"battery",key:"batteryIndicator_".concat(s)},a.a.createElement("rect",{width:34,height:14,stroke:"#CCC",strokeWidth:2,x:2,y:2,rx:2,ry:2,className:"battery-container"}),a.a.createElement("rect",{height:12,width:Math.round(s/100*32),x:3,y:3,rx:2,ry:2,className:"battery-gauge"}),a.a.createElement("rect",{width:4,height:8,x:36,y:6,className:"battery-button"}))),a.a.createElement(d.i,{className:"dashboard-header-toolbar-logo",src:x.a}),a.a.createElement(d.h,{slot:"end"}))),a.a.createElement(d.f,{className:"dashboard-content"},a.a.createElement(d.m,{className:"dashboard-content-list",lines:"none"},a.a.createElement(d.j,{className:"dashboard-content-list-item"},a.a.createElement(d.s,{options:O,pager:!0,ref:k,onIonSlideTransitionEnd:function(e){var t;return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.current){e.next=2;break}return e.abrupt("return");case 2:if(m!==r){e.next=9;break}return e.next=5,u.a.awrap(k.current.getActiveIndex());case 5:(t=e.sent)!==r-1&&(p(K(t+1)),b(t+1)),e.next=10;break;case 9:m!==r&&b(r);case 10:case"end":return e.stop()}}))}},t.map((function(e,t){return a.a.createElement(d.r,{key:t,title:t.toString()},a.a.createElement("div",{className:"swiper-slide-content"},a.a.createElement("svg",{viewBox:"0 0 100 100",onClick:function(){return j(!0)}},a.a.createElement("filter",{id:"shadow"},a.a.createElement("feDropShadow",{dx:"4",dy:"4",stdDeviation:"2",floodColor:"#989aa2"})),a.a.createElement("circle",{cx:"50",cy:"50",r:"46",stroke:"#ccc","stroke-width":"2",className:"shadow"}),a.a.createElement("circle",{cx:"50",cy:"50",r:"44",stroke:"#fafafa","stroke-width":"2",className:"circle"}),a.a.createElement("text",{x:"25",y:"58",fill:"#fafafa"},e.toFixed(0),"\xb0C"))),a.a.createElement("div",{className:"swiper-slide-footer"},a.a.createElement("div",{className:"swiper-slide-footer-text"},me[t])))})))),a.a.createElement(d.j,{className:"dashboard-content-list-footer",hidden:4!==r&&5!==r},a.a.createElement(d.p,{min:100,max:220,step:1,value:r>0&&r<=6&&6===t.length?t[r-1]:0,snaps:!0,color:"danger",onIonChange:function(e){var n=e.detail.value,a=[].concat(Object(v.a)(t.slice(0,r-1)),[n],Object(v.a)(t.slice(r)));p(ae(a)),setTimeout((function(){E.current===n&&p(R(a,r))}),1e3),E.current=n}},a.a.createElement(d.h,{slot:"start",size:"small",color:"danger",icon:he.a}),a.a.createElement(d.h,{slot:"end",color:"danger",icon:he.a}))),a.a.createElement(d.j,{className:"dashboard-content-list-footer",hidden:4===r||5===r},"\xa0"))),a.a.createElement(d.b,{isOpen:g,onDidDismiss:function(){return j(!1)},header:"New Temperature",inputs:[{name:"temperature",type:"number",label:"Temperature",placeholder:"<New Value>",value:r>=1&&r<=6?t[r-1]:0,min:100,max:220}],buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:function(){console.log("Confirm Cancel")}},{text:"Ok",handler:function(e){var t=parseInt(e.temperature);t>=100&&t<=220&&C(t)}}]}),a.a.createElement(d.b,{isOpen:e.displayLockDialog,onDidDismiss:function(){return e.dismissLockDialogCallback()},header:o?"Unlock?":"Lock?",message:"Would you like to ".concat(o?"unlock":"lock"," your Ghost MV1 vaporizer?"),buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary"},{text:"Ok",handler:function(e){p(o?function(e,t){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(e(G()));case 3:return r.next=5,u.a.awrap(e(le()));case 5:return r.next=7,u.a.awrap(z.unlock());case 7:if(!r.sent){r.next=11;break}return r.next=11,u.a.awrap(e(ee(254&t().ble.status)));case 11:return r.prev=11,r.next=14,u.a.awrap(e(de()));case 14:return r.next=16,u.a.awrap(e(W()));case 16:return r.next=18,u.a.awrap(e(se()));case 18:return r.finish(11);case 19:case"end":return r.stop()}}),null,null,[[0,,11,19]])}:function(e,t){return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u.a.awrap(e(G()));case 3:return r.next=5,u.a.awrap(e(ue()));case 5:return r.next=7,u.a.awrap(z.lock());case 7:if(!r.sent){r.next=11;break}return r.next=11,u.a.awrap(e(ee(1|t().ble.status)));case 11:return r.prev=11,r.next=14,u.a.awrap(e(pe()));case 14:return r.next=16,u.a.awrap(e(W()));case 16:return r.next=18,u.a.awrap(e(se()));case 18:return r.finish(11);case 19:case"end":return r.stop()}}),null,null,[[0,,11,19]])})}}]}))},we=(r(401),r(199).version),xe=function(e){var t=e.history,r=Object(n.useState)(!1),c=Object(l.a)(r,2),s=c[0],o=c[1],p=Object(n.useRef)(!1),f=Object(n.useState)(!1),h=Object(l.a)(f,2),m=h[0],b=h[1],v=Object(n.useState)("Loading ..."),w=Object(l.a)(v,2),y=w[0],g=w[1],j=Object(i.c)((function(e){return{connected:e.ble.connected,error:e.ble.error,connectAttempts:e.ble.connectAttempts,connecting:e.ble.connecting,hasKey:""!==e.ble.authKey}})),k=Object(i.b)(),E=function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:b(!1),k(F(p.current));case 2:case"end":return e.stop()}}))},C=Object(n.useCallback)((function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:b(!1),k(B(p.current));case 2:case"end":return e.stop()}}))}),[k]);Object(n.useEffect)((function(){!(j.connectAttempts>0)||j.connecting||j.connected||m?j.connected&&!j.connecting&&t.push("/dashboard"):new Promise((function(e){return setTimeout((function(){return e()}),1e3)})).then((function(){C()}))}),[j.connectAttempts,m,j.connected,j.connecting,t,C]),Object(n.useEffect)((function(){var e=j.connectAttempts>1?"Retrying (attempt #".concat(j.connectAttempts,") ..."):"Connecting ...";if(e!==y){g(e);var t=document.querySelector("div.loading-wrapper div.loading-content");t&&(t.innerHTML=e)}}),[y,j.error,j.connectAttempts]);return a.a.createElement(d.o,{className:"connect"},a.a.createElement(d.k,{class:"version-label"},we),a.a.createElement(d.g,{className:"connect-header"},a.a.createElement(d.w,{className:"connect-header-toolbar"},a.a.createElement(d.i,{className:"connect-header-toolbar-logo",src:x.a}))),a.a.createElement(d.f,{className:"connect-content"},a.a.createElement(d.m,{lines:"none",className:"connect-content-list"},a.a.createElement(d.j,{class:"connect-content-list-spacer"}),a.a.createElement(d.j,{className:"connect-content-list-button",hidden:void 0!==j.error||j.hasKey||j.connecting||j.connected},a.a.createElement(d.d,{onClick:E,size:"large"},"Pair")),a.a.createElement(d.j,{className:"connect-content-list-button",hidden:void 0!==j.error||j.connecting||j.connected||!j.hasKey},a.a.createElement(d.d,{onClick:s?E:C,size:"large"},s?"Pair":"Connect")),a.a.createElement(d.j,{className:"connect-content-list-options",hidden:void 0!==j.error||j.connecting||j.connected||!j.hasKey},a.a.createElement(d.e,{defaultChecked:s,onIonChange:function(e){o(e.detail.checked)},slot:"start"}),a.a.createElement(d.k,null,"Pair device again?")),a.a.createElement(d.j,{className:"connect-content-list-options",hidden:void 0!==j.error||j.connecting||j.connected||!j.hasKey},a.a.createElement(d.e,{defaultChecked:p.current,onIonChange:function(e){p.current=e.detail.checked},slot:"start"}),a.a.createElement(d.k,null,"Show all devices?")),a.a.createElement(d.j,{class:"connect-content-list-spacer"}))),a.a.createElement(d.n,{isOpen:void 0!==j.error||j.connecting,message:y,backdropDismiss:!0,onDidDismiss:function(){b(!0),k((function(e,t){return u.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.awrap(z.disconnect());case 2:return t.next=4,u.a.awrap(e(Y()));case 4:case"end":return t.stop()}}))}))}}))},ye=function(){var e=Object(i.c)((function(e){return e.ble.connected})),t=Object(i.c)((function(e){return e.ble.locked})),r=Object(n.useState)(!1),c=Object(l.a)(r,2),s=c[0],o=c[1],v=function(){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.a.awrap(z.disconnect());case 2:case"end":return e.stop()}}))};Object(n.useEffect)((function(){return window.addEventListener("beforeunload",v),function(){window.removeEventListener("beforeunload",v)}}),[]),Object(n.useEffect)((function(){}),[t]);var w=function(){return a.a.createElement(p.a,{to:"/connect"})},x=function(e){return u.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:o(!0);case 1:case"end":return e.stop()}}))};return a.a.createElement(d.c,null,a.a.createElement(f.a,null,a.a.createElement(d.v,null,a.a.createElement(d.q,null,a.a.createElement(p.b,{path:"/connect",component:xe,exact:!0}),a.a.createElement(p.b,{path:"/dashboard",component:e?function(){return a.a.createElement(ve,{displayLockDialog:s,dismissLockDialogCallback:function(){o(!1)}})}:w,exact:!0}),a.a.createElement(p.b,{path:"/",component:w,exact:!0})),a.a.createElement(d.t,{slot:"bottom"},a.a.createElement(d.u,{tab:"dashboard",href:"/dashboard",hidden:!e},a.a.createElement(d.h,{icon:h.a}),a.a.createElement(d.k,null,"Temperature")),t?a.a.createElement(d.u,{tab:"lock",hidden:!e,onClick:x},a.a.createElement(d.h,{icon:m.a}),a.a.createElement(d.k,null,"Unlock")):a.a.createElement(d.u,{tab:"lock",hidden:!e,onClick:x},a.a.createElement(d.h,{icon:b.a}),a.a.createElement(d.k,null,"Lock"))))))},ge=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function je(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var r=e.installing;null!=r&&(r.onstatechange=function(){"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ke=r(26),Ee=Object(ke.combineReducers)({ble:fe}),Ce=Object(g.a)({reducer:Ee,middleware:Object(v.a)(Object(g.c)())});z.initialize(Ce.dispatch,Ce.getState),s.a.render(a.a.createElement(i.a,{store:Ce},a.a.createElement(ye,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("https://www.jcatvapes.com/ghost",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("https://www.jcatvapes.com/ghost","/service-worker.js");ge?(!function(e,t){fetch(e).then((function(r){var n=r.headers.get("content-type");404===r.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):je(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):je(t,e)}))}}()},95:function(e,t,r){e.exports=r.p+"static/media/logo.eba00710.svg"}},[[230,9,10]]]);
//# sourceMappingURL=main.b83324a1.chunk.js.map